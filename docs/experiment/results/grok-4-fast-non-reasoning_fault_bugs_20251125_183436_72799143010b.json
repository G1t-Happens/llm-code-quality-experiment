[
  {
    "filename": "src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 102,
    "end_line": 108,
    "severity": "critical",
    "error_description": "SQL injection vulnerability in getByUsername method: direct string concatenation in native query 'SELECT * FROM users WHERE username = \\'' + username + '\\'' allows malicious input to alter query structure, hypothesizing nonmalicious development fault (omission of parameterized query), high propagation risk to data exposure or unauthorized access failure"
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 181,
    "end_line": 182,
    "severity": "high",
    "error_description": "NullPointerException risk in checkLogin: userRepository.findByUsername(username).get() assumes Optional is present without prior existence check, hypothesizing nonmalicious development fault (incorrect assumption on repository behavior), medium propagation to erratic failure (NPE crash) if username not found"
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 153,
    "end_line": 153,
    "severity": "high",
    "error_description": "Double password hashing in updateUserEntityFromUserRequest mapping expression: 'passwordEncoder.encode(passwordEncoder.encode(dto.password()))' hashes already hashed password, hypothesizing nonmalicious development fault (incorrect expression in mapper), high propagation to authentication failure (invalid credentials)"
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/AddressServiceImpl.java",
    "start_line": 67,
    "end_line": 67,
    "severity": "high",
    "error_description": "NullPointerException risk in getById: addressRepository.findById(addressId).get() assumes Optional present without check, hypothesizing nonmalicious development fault (omission of orElseThrow), medium propagation to erratic failure if address not found before ownership check"
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/AddressServiceImpl.java",
    "start_line": 96,
    "end_line": 96,
    "severity": "high",
    "error_description": "NullPointerException risk in update: addressRepository.findById(addressId).orElseThrow(...) but subsequent enforceAddressOwnership may fail if user relation lazy-loaded and not initialized, hypothesizing interaction fault (JPA lazy loading timing issue), medium propagation to LazyInitializationException failure"
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/AddressServiceImpl.java",
    "start_line": 116,
    "end_line": 116,
    "severity": "high",
    "error_description": "NullPointerException risk in delete: addressRepository.findById(addressId).orElseThrow but ownership check accesses user.id without null safety, hypothesizing nonmalicious development fault (incomplete null handling in enforceAddressOwnership), medium propagation to NPE if user relation null"
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/controller/UserController.java",
    "start_line": 60,
    "end_line": 62,
    "severity": "medium",
    "error_description": "Missing authorization on delete endpoint: @DeleteMapping lacks @PreAuthorize, allowing any authenticated user to delete any user, hypothesizing nonmalicious development fault (omission of security annotation), high propagation to integrity failure (unauthorized data deletion)"
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/mapper/UserMapper.java",
    "start_line": 55,
    "end_line": 55,
    "severity": "high",
    "error_description": "Incorrect password handling in update mapping: expression re-hashes existing password unnecessarily and double-encodes new ones, hypothesizing design flaw in mapper (logical error in conditional hashing), high propagation to authentication failure for updated users"
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 72,
    "end_line": 81,
    "severity": "low",
    "error_description": "Inefficient pagination in listAll: loads all users into memory then creates PageImpl, hypothesizing performance fault (nonmalicious development omission of repository paging), low propagation risk but potential erratic failure under high load"
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/security/SecurityConfig.java",
    "start_line": 108,
    "end_line": 109,
    "severity": "medium",
    "error_description": "Weak JWT secret handling: Base64 decoding assumes valid input without length/security checks, hypothesizing external fault vulnerability (malicious short secret leading to weak encryption), medium propagation to security failure (token forgery)"
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/AddressServiceImpl.java",
    "start_line": 86,
    "end_line": 87,
    "severity": "medium",
    "error_description": "Missing persistence in save: addressMapper.toAddressEntity creates entity but addressRepository.save not called, hypothesizing critical omission fault (development error in transaction), high propagation to content failure (data not saved)"
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 125,
    "end_line": 126,
    "severity": "low",
    "error_description": "Redundant PasswordEncoder instantiation in save: new BCryptPasswordEncoder() despite injected bean, hypothesizing minor design fault (inconsistency), low propagation but potential for configuration mismatch"
  }
]