[
  {
    "filename": "com/llmquality/baseline/service/AddressServiceImpl.java",
    "start_line": 67,
    "end_line": 67,
    "severity": "critical",
    "error_description": "Unconditional call to Optional.get() on addressRepository.findById(addressId) without checking presence will throw NoSuchElementException if address does not exist, resulting in 500 Internal Server Error instead of proper 404 handling."
  },
  {
    "filename": "com/llmquality/baseline/service/AddressServiceImpl.java",
    "start_line": 87,
    "end_line": 88,
    "severity": "critical",
    "error_description": "Address entity is mapped to AddressResponse and returned without being persisted (addressRepository.save not called), so the returned AddressResponse will not have a generated ID and the entity is not stored in the database."
  },
  {
    "filename": "com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 103,
    "end_line": 104,
    "severity": "critical",
    "error_description": "Direct concatenation of username into SQL string in getByUsername method creates a SQL injection vulnerability, allowing attackers to execute arbitrary SQL via crafted usernames."
  },
  {
    "filename": "com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 182,
    "end_line": 182,
    "severity": "critical",
    "error_description": "Unconditional call to Optional.get() on userRepository.findByUsername(username) without checking presence will throw NoSuchElementException if user does not exist, resulting in 500 Internal Server Error instead of proper 401 Unauthorized."
  },
  {
    "filename": "com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 184,
    "end_line": 185,
    "severity": "critical",
    "error_description": "Password is checked even if user is null, but user.getPassword() is called without null check, which will throw NullPointerException if user is not found."
  },
  {
    "filename": "com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 119,
    "end_line": 119,
    "severity": "high",
    "error_description": "Logging sensitive information: user password is logged in plaintext in save method, violating security best practices and risking credential leakage."
  },
  {
    "filename": "com/llmquality/baseline/mapper/UserMapper.java",
    "start_line": 56,
    "end_line": 56,
    "severity": "high",
    "error_description": "Password is double-encoded in updateUserEntityFromUserRequest: passwordEncoder.encode(passwordEncoder.encode(dto.password())), causing stored password to be hashed twice, breaking authentication."
  },
  {
    "filename": "com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 126,
    "end_line": 127,
    "severity": "medium",
    "error_description": "A new BCryptPasswordEncoder is instantiated locally for each user creation instead of using the injected PasswordEncoder bean, causing inconsistent password hashing configuration and violating dependency injection best practices."
  },
  {
    "filename": "com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 153,
    "end_line": 154,
    "severity": "medium",
    "error_description": "A new BCryptPasswordEncoder is instantiated locally for each user update instead of using the injected PasswordEncoder bean, causing inconsistent password hashing configuration and violating dependency injection best practices."
  },
  {
    "filename": "com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 173,
    "end_line": 174,
    "severity": "medium",
    "error_description": "User entity is not actually deleted from the database in delete method; userRepository.delete(existingUserEntity) is missing, so the user is never removed."
  },
  {
    "filename": "com/llmquality/baseline/service/AddressServiceImpl.java",
    "start_line": 41,
    "end_line": 45,
    "severity": "medium",
    "error_description": "Constructor does not inject UserRepository, but instead relies on field injection (@Autowired private UserRepository userRepository), violating constructor injection best practices and making the class harder to test and maintain."
  },
  {
    "filename": "com/llmquality/baseline/service/AddressServiceImpl.java",
    "start_line": 68,
    "end_line": 68,
    "severity": "medium",
    "error_description": "No check for null or missing address entity before enforcing ownership, which can lead to NullPointerException if the address is not found."
  },
  {
    "filename": "com/llmquality/baseline/service/AddressServiceImpl.java",
    "start_line": 86,
    "end_line": 86,
    "severity": "medium",
    "error_description": "No validation or check for duplicate addresses before saving, which may allow the same address to be added multiple times for a user."
  },
  {
    "filename": "com/llmquality/baseline/service/AddressServiceImpl.java",
    "start_line": 124,
    "end_line": 124,
    "severity": "medium",
    "error_description": "No check for successful deletion or handling of exceptions in addressRepository.delete(existingAddressEntity), which may result in silent failures if the entity is not deleted."
  },
  {
    "filename": "com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 75,
    "end_line": 78,
    "severity": "low",
    "error_description": "listAll method fetches all users into memory and then paginates in Java, causing performance and memory issues for large datasets; should use repository paging instead."
  },
  {
    "filename": "com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 103,
    "end_line": 104,
    "severity": "low",
    "error_description": "Direct use of native SQL for user lookup instead of using repository or parameterized query, reducing maintainability and increasing risk of errors."
  },
  {
    "filename": "com/llmquality/baseline/mapper/UserMapper.java",
    "start_line": 26,
    "end_line": 26,
    "severity": "low",
    "error_description": "No null check for dto.password() in toUserEntity mapping expression, which may cause NullPointerException if password is null."
  },
  {
    "filename": "com/llmquality/baseline/mapper/UserMapper.java",
    "start_line": 56,
    "end_line": 56,
    "severity": "low",
    "error_description": "No null check for dto.password() in updateUserEntityFromUserRequest mapping expression, which may cause NullPointerException if password is null."
  },
  {
    "filename": "com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 236,
    "end_line": 243,
    "severity": "low",
    "error_description": "JWT scope claim uses Role.ADMIN.name() or Role.USER.name(), but JwtAuthenticationConverter expects 'ROLE_ADMIN' or 'ROLE_USER', causing possible role mapping issues."
  },
  {
    "filename": "com/llmquality/baseline/controller/AddressController.java",
    "start_line": 42,
    "end_line": 46,
    "severity": "medium",
    "error_description": "AddressController.create endpoint is annotated with consumes='text/plain', but expects AddressRequest DTO as JSON, causing deserialization errors and failed requests."
  },
  {
    "filename": "com/llmquality/baseline/controller/UserController.java",
    "start_line": 47,
    "end_line": 47,
    "severity": "medium",
    "error_description": "UserController.create does not validate UserRequest with @Validated or @Valid, so invalid user input may bypass validation constraints."
  },
  {
    "filename": "com/llmquality/baseline/controller/UserController.java",
    "start_line": 58,
    "end_line": 60,
    "severity": "medium",
    "error_description": "UserController.delete endpoint is not protected by any @PreAuthorize annotation, allowing any authenticated user to delete any user account."
  },
  {
    "filename": "com/llmquality/baseline/mapper/AddressMapper.java",
    "start_line": 32,
    "end_line": 32,
    "severity": "medium",
    "error_description": "AddressRequest.someValue is mapped to Address.street, but the naming is unclear and may cause confusion or data mapping errors if DTO and entity fields diverge."
  },
  {
    "filename": "com/llmquality/baseline/mapper/AddressMapper.java",
    "start_line": 58,
    "end_line": 58,
    "severity": "medium",
    "error_description": "AddressRequest.someValue is mapped to Address.street in updateAddressEntityFromAddressRequest, but other fields (houseNumber, postalCode, etc.) are not explicitly mapped, causing partial updates to miss important address fields."
  },
  {
    "filename": "com/llmquality/baseline/service/AddressServiceImpl.java",
    "start_line": 48,
    "end_line": 62,
    "severity": "low",
    "error_description": "AddressServiceImpl.listAll logs at DEBUG level but does not handle or mask sensitive data in logs, potentially exposing user IDs and address information in logs."
  },
  {
    "filename": "com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 40,
    "end_line": 40,
    "severity": "low",
    "error_description": "Logger is declared as static final org.slf4j.Logger LOG, but the naming convention (LOG) is inconsistent with typical Java standards (should be 'logger')."
  },
  {
    "filename": "com/llmquality/baseline/service/AddressServiceImpl.java",
    "start_line": 28,
    "end_line": 28,
    "severity": "low",
    "error_description": "Logger is declared as static final org.slf4j.Logger LOG, but the naming convention (LOG) is inconsistent with typical Java standards (should be 'logger')."
  },
  {
    "filename": "com/llmquality/baseline/mapper/AddressMapper.java",
    "start_line": 32,
    "end_line": 32,
    "severity": "low",
    "error_description": "Mapping from AddressRequest.someValue to Address.street is not documented in Javadoc, reducing code readability and maintainability."
  }
]