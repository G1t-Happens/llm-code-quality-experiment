[
  {
    "filename": "src/main/java/com/llmquality/baseline/controller/UserController.java",
    "start_line": 59,
    "end_line": 62,
    "severity": "critical",
    "error_description": "Missing @PreAuthorize annotation on delete method enables any authenticated user to delete arbitrary user accounts without authorization checks (development omission fault)"
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 102,
    "end_line": 102,
    "severity": "critical",
    "error_description": "SQL injection vulnerability in getByUsername method via unsafe native query string concatenation '\" + username + \"' (human-made development fault: improper input sanitization)"
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/mapper/UserMapper.java",
    "start_line": 55,
    "end_line": 55,
    "severity": "critical",
    "error_description": "Double password encoding in updateUserEntityFromUserRequest mapper expression 'passwordEncoder.encode(passwordEncoder.encode(dto.password()))' corrupts password hashes on updates (development fault: coding mistake in MapStruct expression)"
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/AddressServiceImpl.java",
    "start_line": 86,
    "end_line": 89,
    "severity": "critical",
    "error_description": "Omission of addressRepository.save(addressEntity) in save method causes addresses to not persist to database and returns null ID (development fault: accidental removal or omission of persistence call)"
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 172,
    "end_line": 173,
    "severity": "critical",
    "error_description": "Missing userRepository.delete(existingUserEntity) in delete method: logs deletion but leaves user in database (development fault: incomplete implementation)"
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 74,
    "end_line": 82,
    "severity": "high",
    "error_description": "Broken pagination in listAll: loads all users via findAll() and wraps in PageImpl ignoring pageable slicing, returns full list always (development fault: misuse of PageImpl constructor)"
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 181,
    "end_line": 182,
    "severity": "high",
    "error_description": "checkLogin uses .get() on Optional causing NoSuchElementException for non-existent users instead of UnauthorizedException, incomplete timing attack mitigation (development fault: improper Optional handling)"
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/controller/AddressController.java",
    "start_line": 44,
    "end_line": 48,
    "severity": "high",
    "error_description": "Unusual @PostMapping(consumes = \"text/plain\") mismatches JSON DTO deserialization for AddressRequest, likely prevents address creation (development fault: incorrect media type specification)"
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/AddressServiceImpl.java",
    "start_line": 67,
    "end_line": 67,
    "severity": "medium",
    "error_description": "Inconsistent Optional handling in getById uses .get() risking NoSuchElementException unlike other methods using orElseThrow (development fault: inconsistent error handling pattern)"
  }
]