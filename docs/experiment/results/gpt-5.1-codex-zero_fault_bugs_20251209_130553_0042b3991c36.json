[
  {
    "filename": "/home/dbe/projects/llm-code-quality-experiment/baseline_project_buggy/src/main/java/com/llmquality/baseline/controller/AddressController.java",
    "start_line": 44,
    "end_line": 47,
    "error_description": "POST /users/{userId}/addresses is declared to consume only text/plain even though it accepts an AddressRequest JSON body; standard application/json requests will be rejected with 415.",
    "confidence": 0.79
  },
  {
    "filename": "/home/dbe/projects/llm-code-quality-experiment/baseline_project_buggy/src/main/java/com/llmquality/baseline/controller/AddressController.java",
    "start_line": 50,
    "end_line": 53,
    "error_description": "The update endpoint does not annotate the AddressRequest with @Validated(Update.class)/@Valid, so Bean Validation constraints for updates never execute and invalid data is accepted.",
    "confidence": 0.69
  },
  {
    "filename": "/home/dbe/projects/llm-code-quality-experiment/baseline_project_buggy/src/main/java/com/llmquality/baseline/controller/UserController.java",
    "start_line": 47,
    "end_line": 51,
    "error_description": "User creation lacks @Validated(Create.class) (or @Valid) on the UserRequest parameter, meaning required-field constraints are never enforced when creating users.",
    "confidence": 0.74
  },
  {
    "filename": "/home/dbe/projects/llm-code-quality-experiment/baseline_project_buggy/src/main/java/com/llmquality/baseline/controller/UserController.java",
    "start_line": 59,
    "end_line": 62,
    "error_description": "DELETE /users/{id} has no @PreAuthorize check, so any authenticated user can delete any account, bypassing the admin/owner restrictions applied elsewhere.",
    "confidence": 0.77
  },
  {
    "filename": "/home/dbe/projects/llm-code-quality-experiment/baseline_project_buggy/src/main/java/com/llmquality/baseline/service/AddressServiceImpl.java",
    "start_line": 65,
    "end_line": 73,
    "error_description": "getById uses addressRepository.findById(addressId).get(); when an address does not exist it throws NoSuchElementException and produces a 500 instead of the intended 404 ResourceNotFoundException.",
    "confidence": 0.83
  },
  {
    "filename": "/home/dbe/projects/llm-code-quality-experiment/baseline_project_buggy/src/main/java/com/llmquality/baseline/service/AddressServiceImpl.java",
    "start_line": 78,
    "end_line": 89,
    "error_description": "save() maps the AddressRequest to an entity and returns a DTO without ever persisting through addressRepository.save(), so the address is never stored and the returned id remains null.",
    "confidence": 0.84
  },
  {
    "filename": "/home/dbe/projects/llm-code-quality-experiment/baseline_project_buggy/src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 72,
    "end_line": 81,
    "error_description": "listAll(Pageable) ignores the provided Pageable by calling userRepository.findAll() and wrapping the full list in a PageImpl, producing incorrect slices and loading all users into memory.",
    "confidence": 0.76
  },
  {
    "filename": "/home/dbe/projects/llm-code-quality-experiment/baseline_project_buggy/src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 99,
    "end_line": 107,
    "error_description": "getByUsername builds a native SQL string via concatenation (\"SELECT * FROM users WHERE username = '\" + username + \"'\") which is vulnerable to SQL injection; user input reaches the query unescaped.",
    "confidence": 0.88
  },
  {
    "filename": "/home/dbe/projects/llm-code-quality-experiment/baseline_project_buggy/src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 117,
    "end_line": 119,
    "error_description": "save() logs \"user with name: {} and password: {}\" leaking the supplied password into the application logs, exposing sensitive credentials.",
    "confidence": 0.71
  },
  {
    "filename": "/home/dbe/projects/llm-code-quality-experiment/baseline_project_buggy/src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 161,
    "end_line": 173,
    "error_description": "delete() checks that the user exists but never calls userRepository.delete(...), so DELETE /users/{id} is effectively a no-op.",
    "confidence": 0.82
  },
  {
    "filename": "/home/dbe/projects/llm-code-quality-experiment/baseline_project_buggy/src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 175,
    "end_line": 190,
    "error_description": "checkLogin() invokes userRepository.findByUsername(username).get(); a missing user triggers NoSuchElementException before UnauthorizedException can be thrown, returning a 500 and rendering the dummy-hash timing mitigation useless.",
    "confidence": 0.86
  },
  {
    "filename": "/home/dbe/projects/llm-code-quality-experiment/baseline_project_buggy/src/main/java/com/llmquality/baseline/mapper/UserMapper.java",
    "start_line": 22,
    "end_line": 25,
    "error_description": "updateUserEntityFromUserRequest encodes the password twice (passwordEncoder.encode(passwordEncoder.encode(...))), so updated passwords are double-hashed and will never match during login.",
    "confidence": 0.87
  }
]