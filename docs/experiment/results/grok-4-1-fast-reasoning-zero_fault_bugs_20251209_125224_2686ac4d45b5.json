[
  {
    "filename": "src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 102,
    "end_line": 103,
    "error_description": "SQL injection vulnerability: user-provided 'username' is directly concatenated into native SQL query without parameterization or escaping.",
    "confidence": 1.0
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/mapper/UserMapper.java",
    "start_line": 55,
    "end_line": 55,
    "error_description": "Double password hashing in update mapping expression: passwordEncoder.encode(passwordEncoder.encode(dto.password())), causes BCrypt.matches(plain, double_hash) to fail on login.",
    "confidence": 1.0
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/AddressServiceImpl.java",
    "start_line": 86,
    "end_line": 87,
    "error_description": "Missing persistence call: addressEntity mapped from request but addressRepository.save(addressEntity) omitted, address never saved to database.",
    "confidence": 1.0
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 163,
    "end_line": 173,
    "error_description": "Incomplete delete implementation: loads user entity but omits userRepository.delete(existingUserEntity), method logs deletion but performs no actual delete.",
    "confidence": 1.0
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 72,
    "end_line": 82,
    "error_description": "Broken pagination: userRepository.findAll() ignores Pageable, PageImpl constructed with full list as content leads to incorrect page content and metadata.",
    "confidence": 1.0
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/AddressServiceImpl.java",
    "start_line": 67,
    "end_line": 67,
    "error_description": "Unsafe Optional.get(): addressRepository.findById(addressId).get() throws NoSuchElementException if not found instead of ResourceNotFoundException.",
    "confidence": 1.0
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 181,
    "end_line": 181,
    "error_description": "Unsafe Optional.get() in checkLogin: userRepository.findByUsername(username).get() throws if absent, skips timing-safe dummy hash check.",
    "confidence": 1.0
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/controller/UserController.java",
    "start_line": 59,
    "end_line": 62,
    "error_description": "Missing authorization: @DeleteMapping lacks @PreAuthorize, permits any authenticated user to delete arbitrary users.",
    "confidence": 1.0
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/controller/UserController.java",
    "start_line": 47,
    "end_line": 51,
    "error_description": "Missing validation: @PostMapping create lacks @Validated(Create.class) on UserRequest, skips validation groups and constraints.",
    "confidence": 0.95
  }
]