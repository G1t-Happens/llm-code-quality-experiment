[
  {
    "filename": "src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 102,
    "end_line": 108,
    "severity": "critical",
    "error_description": "SQL injection vulnerability in getByUsername method: Raw SQL concatenation with user input 'username' without parameterization, allowing malicious input to alter query structure and extract/modify data (hypothesized nonmalicious development fault: omission of prepared statements, high probability due to direct string interpolation)"
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 153,
    "end_line": 153,
    "severity": "high",
    "error_description": "Double password hashing in updateUserEntityFromUserRequest mapping: Expression applies passwordEncoder.encode twice on dto.password(), resulting in incorrect hash that fails authentication (hypothesized nonmalicious development fault: logic error in MapStruct expression, high probability as it deviates from single-encode pattern in toUserEntity)"
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/AddressServiceImpl.java",
    "start_line": 67,
    "end_line": 67,
    "severity": "high",
    "error_description": "NullPointerException risk in getById: Unchecked .get() on potentially empty Optional from addressRepository.findById(addressId), assuming existence without handling (hypothesized nonmalicious development fault: omission of orElseThrow, medium probability as it precedes ownership check but fails early)"
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 181,
    "end_line": 181,
    "severity": "high",
    "error_description": "NullPointerException in checkLogin: Unchecked .get() on userRepository.findByUsername(username) which may return empty Optional, causing runtime failure before password validation (hypothesized nonmalicious development fault: inconsistent null handling vs. other methods using orElseThrow, high probability)"
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/controller/UserController.java",
    "start_line": 59,
    "end_line": 62,
    "severity": "high",
    "error_description": "Missing authorization on delete endpoint: No @PreAuthorize annotation allows any authenticated user to delete any user, violating ownership principle (hypothesized nonmalicious development fault: omission of security annotation, high probability as other CRUD methods have explicit checks)"
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/AddressServiceImpl.java",
    "start_line": 86,
    "end_line": 87,
    "severity": "medium",
    "error_description": "Premature mapping in save: toAddressEntity followed immediately by toAddressResponse on unsaved entity, returning generated ID=0 instead of actual database ID (hypothesized nonmalicious development fault: incorrect assumption about entity state post-mapping pre-save, medium probability as response lacks real ID until next query)"
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 126,
    "end_line": 127,
    "severity": "medium",
    "error_description": "Redundant PasswordEncoder instantiation in save: Creates new BCryptPasswordEncoder() instead of injecting shared instance, risking configuration inconsistencies (hypothesized nonmalicious development fault: unnecessary local creation vs. field injection, low probability but deviates from DI pattern)"
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/logging/LoggingConfig.java",
    "start_line": 209,
    "end_line": 210,
    "severity": "low",
    "error_description": "Potential log injection in createRollingFileAppender: totalSizeCapStr parsed without validation, allowing malformed input to disrupt rolling policy (hypothesized external interaction fault: untrusted config value, low probability as it's application property but could be tampered in env)"
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/controller/AddressController.java",
    "start_line": 44,
    "end_line": 48,
    "severity": "medium",
    "error_description": "Inconsistent content type handling in create: @PostMapping(consumes = \"text/plain\") mismatches typical JSON expectations for @RequestBody, potentially rejecting valid JSON requests (hypothesized nonmalicious development fault: restrictive consumes clause, medium probability causing client errors)"
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 72,
    "end_line": 82,
    "severity": "low",
    "error_description": "Inefficient pagination in listAll: Loads all users into memory via findAll() then creates PageImpl, unsuitable for large datasets (hypothesized nonmalicious development fault: misuse of repository for pagination, low propagation risk but performance degradation under load)"
  }
]