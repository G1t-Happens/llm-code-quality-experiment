[
  {
    "filename": "com/llmquality/baseline/service/AddressServiceImpl.java",
    "start_line": 67,
    "end_line": 67,
    "severity": "critical",
    "error_description": "AddressServiceImpl.getById() uses addressRepository.findById(addressId).get() without checking if the Optional is present, causing NoSuchElementException at runtime if the address does not exist."
  },
  {
    "filename": "com/llmquality/baseline/service/AddressServiceImpl.java",
    "start_line": 87,
    "end_line": 88,
    "severity": "critical",
    "error_description": "AddressServiceImpl.save() creates Address entity from request and user, then immediately maps it to AddressResponse without persisting (addressRepository.save), so the returned AddressResponse will have null id and not be present in the database."
  },
  {
    "filename": "com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 103,
    "end_line": 104,
    "severity": "critical",
    "error_description": "UserServiceImpl.getByUsername() constructs SQL via string concatenation with untrusted 'username', causing a SQL injection vulnerability."
  },
  {
    "filename": "com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 182,
    "end_line": 182,
    "severity": "critical",
    "error_description": "UserServiceImpl.checkLogin() calls userRepository.findByUsername(username).get() without checking if the Optional is present, causing NoSuchElementException if the user does not exist."
  },
  {
    "filename": "com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 184,
    "end_line": 185,
    "severity": "critical",
    "error_description": "UserServiceImpl.checkLogin() performs password check after forcibly dereferencing user, so if user is not found, code will throw before reaching dummy hash logic, breaking timing attack mitigation and leaking user existence."
  },
  {
    "filename": "com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 119,
    "end_line": 119,
    "severity": "high",
    "error_description": "UserServiceImpl.save() logs the plaintext password in debug logs, which is a severe security risk and leaks sensitive credentials."
  },
  {
    "filename": "com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 126,
    "end_line": 127,
    "severity": "high",
    "error_description": "UserServiceImpl.save() uses a new BCryptPasswordEncoder instance instead of the injected PasswordEncoder, causing password hash algorithm drift and inconsistent password verification."
  },
  {
    "filename": "com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 153,
    "end_line": 154,
    "severity": "high",
    "error_description": "UserServiceImpl.update() uses a new BCryptPasswordEncoder instance instead of the injected PasswordEncoder, causing inconsistent password hashing and potential login failures."
  },
  {
    "filename": "com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 173,
    "end_line": 174,
    "severity": "medium",
    "error_description": "UserServiceImpl.delete() does not actually delete the user entity from the database, so the user remains present after a delete operation."
  },
  {
    "filename": "com/llmquality/baseline/mapper/UserMapper.java",
    "start_line": 55,
    "end_line": 56,
    "severity": "high",
    "error_description": "UserMapper.updateUserEntityFromUserRequest() double-hashes the password by calling passwordEncoder.encode(passwordEncoder.encode(dto.password())), resulting in unusable password hashes and login failures."
  },
  {
    "filename": "com/llmquality/baseline/controller/AddressController.java",
    "start_line": 42,
    "end_line": 44,
    "severity": "medium",
    "error_description": "AddressController.create() is mapped with consumes = 'text/plain', but expects a JSON AddressRequest body, causing deserialization errors and making the endpoint unusable for standard clients."
  },
  {
    "filename": "com/llmquality/baseline/service/AddressServiceImpl.java",
    "start_line": 36,
    "end_line": 36,
    "severity": "medium",
    "error_description": "AddressServiceImpl uses field injection (@Autowired private UserRepository userRepository;) instead of constructor injection, violating Clean Code and maintainability best practices."
  },
  {
    "filename": "com/llmquality/baseline/service/AddressServiceImpl.java",
    "start_line": 41,
    "end_line": 45,
    "severity": "medium",
    "error_description": "AddressServiceImpl constructor does not include UserRepository, so the field is injected separately, reducing testability and increasing risk of null pointer exceptions."
  },
  {
    "filename": "com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 80,
    "end_line": 80,
    "severity": "medium",
    "error_description": "UserServiceImpl.listAll() uses userRepository.findAll() and then pages in memory, which is inefficient for large datasets and can cause performance and memory issues."
  },
  {
    "filename": "com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 103,
    "end_line": 104,
    "severity": "high",
    "error_description": "UserServiceImpl.getByUsername() bypasses repository and uses raw SQL, breaking abstraction, maintainability, and testability."
  },
  {
    "filename": "com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 103,
    "end_line": 104,
    "severity": "medium",
    "error_description": "UserServiceImpl.getByUsername() does not handle SQL exceptions or malformed usernames, risking runtime errors and undefined states."
  },
  {
    "filename": "com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 182,
    "end_line": 185,
    "severity": "high",
    "error_description": "UserServiceImpl.checkLogin() does not handle null or blank username, which can result in NullPointerException or authentication bypass."
  },
  {
    "filename": "com/llmquality/baseline/mapper/AddressMapper.java",
    "start_line": 31,
    "end_line": 32,
    "severity": "medium",
    "error_description": "AddressMapper.toAddressEntity() maps AddressRequest.someValue to Address.street, which is non-obvious and violates Clean Code naming conventions, reducing code readability and maintainability."
  },
  {
    "filename": "com/llmquality/baseline/mapper/AddressMapper.java",
    "start_line": 58,
    "end_line": 58,
    "severity": "medium",
    "error_description": "AddressMapper.updateAddressEntityFromAddressRequest() maps AddressRequest.someValue to Address.street, which is confusing and makes the mapping logic unclear."
  },
  {
    "filename": "com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 236,
    "end_line": 243,
    "severity": "medium",
    "error_description": "UserServiceImpl.generateJwtToken() sets scope claim to Role.ADMIN.name() or Role.USER.name(), but JwtAuthenticationConverter expects 'ROLE_ADMIN'/'ROLE_USER', causing authorization failures."
  },
  {
    "filename": "com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 236,
    "end_line": 243,
    "severity": "medium",
    "error_description": "UserServiceImpl.generateJwtToken() sets JWT subject to user ID (String.valueOf(user.getId())), but SecurityExpressions.isOwner() expects auth.getName() to be user ID as string, which may not match if principal is username."
  },
  {
    "filename": "com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 236,
    "end_line": 243,
    "severity": "medium",
    "error_description": "UserServiceImpl.generateJwtToken() does not include username or email in JWT claims, reducing usability for downstream services and auditability."
  },
  {
    "filename": "com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 177,
    "end_line": 195,
    "severity": "medium",
    "error_description": "UserServiceImpl.checkLogin() does not rate-limit login attempts or track failed logins, making brute-force attacks easier."
  },
  {
    "filename": "com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 206,
    "end_line": 215,
    "severity": "low",
    "error_description": "UserServiceImpl.do_Some_Stuff() uses a non-descriptive method name, violating Clean Code naming conventions and reducing code readability."
  },
  {
    "filename": "com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 236,
    "end_line": 243,
    "severity": "low",
    "error_description": "UserServiceImpl.generateJwtToken() does not set JWT ID (jti) claim, reducing traceability and security for token revocation."
  },
  {
    "filename": "com/llmquality/baseline/service/AddressServiceImpl.java",
    "start_line": 49,
    "end_line": 49,
    "severity": "low",
    "error_description": "AddressServiceImpl.listAll() logs potentially sensitive pagination parameters at debug level, which may leak information in production logs."
  },
  {
    "filename": "com/llmquality/baseline/service/AddressServiceImpl.java",
    "start_line": 50,
    "end_line": 50,
    "severity": "low",
    "error_description": "AddressServiceImpl.listAll() does not validate pageable input, allowing negative page numbers or sizes, which could cause runtime errors or denial of service."
  },
  {
    "filename": "com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 147,
    "end_line": 150,
    "severity": "low",
    "error_description": "UserServiceImpl.update() does not validate new username for invalid characters or reserved words, risking data integrity."
  },
  {
    "filename": "com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 236,
    "end_line": 243,
    "severity": "low",
    "error_description": "UserServiceImpl.generateJwtToken() does not set 'aud' (audience) claim, which may reduce security in multi-client environments."
  },
  {
    "filename": "com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 236,
    "end_line": 243,
    "severity": "low",
    "error_description": "UserServiceImpl.generateJwtToken() does not set 'nbf' (not before) claim, which may allow tokens to be accepted before intended."
  },
  {
    "filename": "com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 236,
    "end_line": 243,
    "severity": "low",
    "error_description": "UserServiceImpl.generateJwtToken() does not include user roles as a list in JWT claims, which may limit future extensibility."
  },
  {
    "filename": "com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 236,
    "end_line": 243,
    "severity": "low",
    "error_description": "UserServiceImpl.generateJwtToken() does not sign JWT with a key rotation mechanism, reducing long-term security."
  }
]