[
  {
    "filename": "src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 99,
    "end_line": 113,
    "severity": "critical",
    "error_description": "SQL injection vulnerability in getByUsername method: Raw SQL concatenation 'SELECT * FROM users WHERE username = \\'' + username + '\\'' allows malicious input to manipulate queries, hypothesizing a nonmalicious development fault (omission of parameterized queries) with high probability due to direct string interpolation without escaping."
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 125,
    "end_line": 126,
    "severity": "medium",
    "error_description": "Redundant PasswordEncoder instantiation in save method: New BCryptPasswordEncoder() created locally instead of using injected bean, hypothesizing a nonmalicious development fault (inconsistency in dependency usage) with medium probability, potentially leading to inconsistent hashing if encoder configurations differ."
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 152,
    "end_line": 153,
    "severity": "high",
    "error_description": "Double password hashing in update method: Expression 'passwordEncoder.encode(passwordEncoder.encode(dto.password()))' applies BCrypt twice, corrupting the hash and breaking authentication, hypothesizing a nonmalicious development fault (incorrect MapStruct expression) with high probability as it deviates from single hashing standard."
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 181,
    "end_line": 182,
    "severity": "high",
    "error_description": "NullPointerException risk in checkLogin: userRepository.findByUsername(username).get() assumes non-null without prior existence check, hypothesizing a nonmalicious development fault (omission of Optional handling) with high probability, causing runtime failure if user doesn't exist before password validation."
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/controller/UserController.java",
    "start_line": 59,
    "end_line": 62,
    "severity": "high",
    "error_description": "Missing authorization on delete endpoint: @DeleteMapping lacks @PreAuthorize, allowing unauthenticated deletion of any user, hypothesizing a nonmalicious development fault (omission of security annotation) with high probability, enabling unauthorized data removal."
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/AddressServiceImpl.java",
    "start_line": 67,
    "end_line": 68,
    "severity": "high",
    "error_description": "NullPointerException in getById: addressRepository.findById(addressId).get() without Optional check, hypothesizing a nonmalicious development fault (improper exception handling) with high probability, crashing on non-existent address before ownership enforcement."
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/AddressServiceImpl.java",
    "start_line": 96,
    "end_line": 97,
    "severity": "high",
    "error_description": "Inconsistent error handling in update: Uses orElseThrow for Address but not in getById, hypothesizing a nonmalicious development fault (incomplete refactoring) with medium probability, leading to potential NPE in one path while properly handling in another."
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/AddressServiceImpl.java",
    "start_line": 115,
    "end_line": 116,
    "severity": "high",
    "error_description": "NullPointerException in delete: addressRepository.findById(addressId) without handling non-existent ID, hypothesizing a nonmalicious development fault (copy-paste error from other methods) with high probability, failing before ownership check."
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/mapper/UserMapper.java",
    "start_line": 55,
    "end_line": 56,
    "severity": "critical",
    "error_description": "Incorrect password update logic in updateUserEntityFromUserRequest: Double encodes password and fails to preserve original if null, hypothesizing a nonmalicious development fault (logical error in conditional expression) with high probability, breaking password updates and authentication."
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 72,
    "end_line": 82,
    "severity": "low",
    "error_description": "Inefficient pagination in listAll: Loads all users into memory then creates PageImpl, hypothesizing a nonmalicious development fault (omission of repository paging) with low probability for small datasets but high risk of OOM failure under load."
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/controller/AddressController.java",
    "start_line": 44,
    "end_line": 48,
    "severity": "medium",
    "error_description": "Unusual consumes='text/plain' on POST: Restricts content-type unnecessarily for JSON API, hypothesizing a nonmalicious development fault (misconfiguration) with medium probability, potentially breaking clients sending standard application/json."
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/security/SecurityConfig.java",
    "start_line": 64,
    "end_line": 68,
    "severity": "medium",
    "error_description": "Overly permissive permitAll on user creation: Allows unauthenticated POST /users without rate limiting, hypothesizing a nonmalicious development fault (insufficient access control) with medium probability, enabling spam or DoS via mass user creation."
  }
]