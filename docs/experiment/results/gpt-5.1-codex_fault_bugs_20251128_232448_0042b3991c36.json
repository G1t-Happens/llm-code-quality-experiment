[
  {
    "filename": "src/main/java/com/llmquality/baseline/controller/AddressController.java",
    "start_line": 44,
    "end_line": 47,
    "error_description": "The create endpoint is restricted to requests with Content-Type text/plain even though it expects a JSON AddressRequest body, so standard application/json clients receive 415 Unsupported Media Type and cannot create addresses."
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/controller/AddressController.java",
    "start_line": 50,
    "end_line": 53,
    "error_description": "The update endpoint does not annotate the payload with @Validated(Update.class); since all update constraints in AddressRequest belong to the Update group, this method performs no validation and accepts invalid/blank address data."
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/controller/UserController.java",
    "start_line": 47,
    "end_line": 51,
    "error_description": "User creation lacks @Valid/@Validated(Create.class) on the request body, so none of the group-scoped constraints in UserRequest (username uniqueness, password strength, email format, etc.) are enforced."
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/controller/UserController.java",
    "start_line": 59,
    "end_line": 61,
    "error_description": "The delete endpoint has no @PreAuthorize guard, allowing any authenticated user to delete arbitrary users despite other operations being restricted to admins/owners."
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/AddressServiceImpl.java",
    "start_line": 65,
    "end_line": 69,
    "error_description": "getById invokes addressRepository.findById(...).get() without checking presence; a missing address causes NoSuchElementException (HTTP 500) instead of returning a controlled ResourceNotFoundException."
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/AddressServiceImpl.java",
    "start_line": 80,
    "end_line": 89,
    "error_description": "save() builds an Address entity and immediately maps it back to a DTO without ever calling addressRepository.save(...), so no database insert occurs and the returned response lacks a generated id."
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/mapper/UserMapper.java",
    "start_line": 53,
    "end_line": 56,
    "error_description": "updateUserEntityFromUserRequest encodes passwords with passwordEncoder.encode(passwordEncoder.encode(dto.password())), storing bcrypt(bcrypt(raw)) and making updated passwords impossible to verify during login."
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 73,
    "end_line": 80,
    "error_description": "listAll ignores the supplied Pageable and loads every user via findAll(), so pagination metadata does not match the content and each call performs a full-table read regardless of requested page/size."
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 120,
    "end_line": 121,
    "error_description": "The save method logs usernames together with the raw password string, leaking credentials into application logs and violating security best practices."
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 99,
    "end_line": 104,
    "error_description": "getByUsername concatenates the username directly into a native SQL string (`SELECT * FROM users WHERE username = '` + username + `'`), enabling SQL injection and bypassing parameter binding."
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 162,
    "end_line": 171,
    "error_description": "delete(Long id) loads the user but never calls userRepository.delete(...); the method reports success without removing anything from the database."
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 176,
    "end_line": 189,
    "error_description": "checkLogin calls userRepository.findByUsername(...).get() before validating credentials; when the username does not exist it throws NoSuchElementException (500) and the intended constant-time dummy hash/UnauthorizedException path is never executed."
  }
]