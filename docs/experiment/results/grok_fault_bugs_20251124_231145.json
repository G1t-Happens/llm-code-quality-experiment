[
  {
    "filename": "src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 102,
    "end_line": 108,
    "severity": "critical",
    "error_description": "SQL injection vulnerability in getByUsername method: direct string concatenation in native query 'SELECT * FROM users WHERE username = \\'' + username + '\\'' allows malicious input to manipulate database, hypothesizing nonmalicious development fault (omission of parameterized queries), high propagation risk to data integrity failure via unauthorized access or data exfiltration."
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 181,
    "end_line": 186,
    "severity": "high",
    "error_description": "NullPointerException risk in checkLogin: userRepository.findByUsername(username).get() assumes non-null result without prior existence check, causing runtime error if user not found; hypothesizing nonmalicious development fault (incomplete error handling), medium propagation to erratic failure (500 errors), mitigated partially by dummy hash but still exposes NPE."
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 152,
    "end_line": 156,
    "severity": "high",
    "error_description": "Double password hashing in update method: expression 'passwordEncoder.encode(passwordEncoder.encode(dto.password()))' re-hashes already hashed password if provided, corrupting credentials; hypothesizing nonmalicious development fault (incorrect mapping logic in UserMapper), high propagation to authentication failure for updated users."
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/AddressServiceImpl.java",
    "start_line": 67,
    "end_line": 67,
    "severity": "high",
    "error_description": "NullPointerException in getById: addressRepository.findById(addressId).get() without Optional check assumes existence, failing if address not found before ownership enforcement; hypothesizing nonmalicious development fault (inconsistent error handling vs. other methods), medium propagation to erratic failure."
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/AddressServiceImpl.java",
    "start_line": 96,
    "end_line": 100,
    "severity": "medium",
    "error_description": "Inconsistent error logging in update: LOG.error called inside orElseThrow lambda without execution guarantee if entity found, potentially missing logs; hypothesizing low-probability development fault (logging placement), low propagation but reduces dependability in operational phase."
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/AddressServiceImpl.java",
    "start_line": 116,
    "end_line": 120,
    "severity": "medium",
    "error_description": "Repeated findById in delete: addressRepository.findById(addressId) without caching or batching, inefficient for high-load; hypothesizing nonmalicious development fault (performance omission), low propagation to timing failure under load."
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/mapper/UserMapper.java",
    "start_line": 55,
    "end_line": 56,
    "severity": "high",
    "error_description": "Incorrect double encoding in updateUserEntityFromUserRequest mapping expression, leading to invalid password hashes on updates; hypothesizing nonmalicious development fault (logical error in MapStruct expression), high risk to security failure (broken logins post-update)."
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/controller/UserController.java",
    "start_line": 59,
    "end_line": 62,
    "severity": "high",
    "error_description": "Missing @PreAuthorize on delete endpoint: allows any authenticated user to delete any user without ownership or admin check, violating security model; hypothesizing nonmalicious development fault (omission), critical propagation to integrity failure (unauthorized deletions)."
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/controller/AddressController.java",
    "start_line": 44,
    "end_line": 48,
    "severity": "medium",
    "error_description": "Unusual consumes='text/plain' on POST create: mismatches typical JSON expectations, potential for malformed requests; hypothesizing low-probability interaction fault (API design mismatch), medium risk to erratic failure in content negotiation."
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/logging/LoggingConfig.java",
    "start_line": 90,
    "end_line": 138,
    "severity": "medium",
    "error_description": "Race condition in initializeLogging: non-atomic 'initialized' check and set without proper synchronization in multi-threaded startup, potential multiple initializations; hypothesizing nonmalicious development fault (concurrency omission), low propagation to resource waste but affects dependability."
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 72,
    "end_line": 82,
    "severity": "low",
    "error_description": "Inefficient pagination in listAll: loads all users into memory then creates PageImpl, unsuitable for large datasets; hypothesizing nonmalicious development fault (scalability oversight), low immediate risk but potential timing failure under growth."
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/entity/Address.java",
    "start_line": 105,
    "end_line": 114,
    "severity": "low",
    "error_description": "Incomplete equals/hashCode: only considers id, ignoring other fields for business equality (e.g., duplicate addresses); hypothesizing nonmalicious development fault (shallow entity comparison), low propagation but risks inconsistency in collections."
  }
]