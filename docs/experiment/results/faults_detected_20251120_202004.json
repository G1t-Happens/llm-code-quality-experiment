[
  {
    "filename": "service/UserServiceImpl.java",
    "start_line": 103,
    "end_line": 104,
    "severity": "critical",
    "error_description": "Directly concatenating the username into the SQL query in getByUsername() enables SQL injection. This violates Security – Integrity and Confidentiality, as an attacker can manipulate the query to access or modify unauthorized data."
  },
  {
    "filename": "service/UserServiceImpl.java",
    "start_line": 182,
    "end_line": 182,
    "severity": "critical",
    "error_description": "Direct use of Optional.get() on userRepository.findByUsername(username) without checking presence in checkLogin() causes NoSuchElementException if the user does not exist. This breaks Reliability – Fault Tolerance and can be exploited for denial of service."
  },
  {
    "filename": "service/UserServiceImpl.java",
    "start_line": 126,
    "end_line": 127,
    "severity": "critical",
    "error_description": "A new BCryptPasswordEncoder is instantiated locally for user creation, instead of using the injected PasswordEncoder bean. This can result in inconsistent password hashes and violates Security – Confidentiality and Reliability – Consistency."
  },
  {
    "filename": "service/UserServiceImpl.java",
    "start_line": 153,
    "end_line": 154,
    "severity": "critical",
    "error_description": "A new BCryptPasswordEncoder is instantiated locally for user update, instead of using the injected PasswordEncoder bean. This can result in inconsistent password hashes and violates Security – Confidentiality and Reliability – Consistency."
  },
  {
    "filename": "service/UserServiceImpl.java",
    "start_line": 174,
    "end_line": 174,
    "severity": "critical",
    "error_description": "The delete() method does not actually delete the user entity from the database. This violates Functionality – Suitability and Reliability – Consistency, as the user remains in the system despite the API contract."
  },
  {
    "filename": "service/UserServiceImpl.java",
    "start_line": 183,
    "end_line": 185,
    "severity": "high",
    "error_description": "Password hash is retrieved from user.getPassword() without null check. If user is null, this will throw NullPointerException. This violates Reliability – Fault Tolerance and can be used for denial of service."
  },
  {
    "filename": "service/UserServiceImpl.java",
    "start_line": 119,
    "end_line": 119,
    "severity": "high",
    "error_description": "Logging the raw password in save() exposes sensitive credentials in logs. This violates Security – Confidentiality and can lead to credential leakage."
  },
  {
    "filename": "service/UserServiceImpl.java",
    "start_line": 56,
    "end_line": 56,
    "severity": "high",
    "error_description": "JwtEncoder is injected and used without verifying the secret key's strength or format. If misconfigured, this can result in weak JWTs, violating Security – Confidentiality and Integrity."
  },
  {
    "filename": "service/UserServiceImpl.java",
    "start_line": 236,
    "end_line": 242,
    "severity": "high",
    "error_description": "The JWT 'scope' claim is set to Role.ADMIN.name() or Role.USER.name(), but the JwtAuthenticationConverter expects 'ROLE_' prefix. This causes authorization mismatches, violating Functionality – Interoperability and Security – Authorization."
  },
  {
    "filename": "service/AddressServiceImpl.java",
    "start_line": 67,
    "end_line": 67,
    "severity": "high",
    "error_description": "Direct use of Optional.get() on addressRepository.findById(addressId) in getById() without checking presence causes NoSuchElementException if the address does not exist. This breaks Reliability – Fault Tolerance and can be exploited for denial of service."
  },
  {
    "filename": "service/AddressServiceImpl.java",
    "start_line": 87,
    "end_line": 89,
    "severity": "high",
    "error_description": "Address entity is mapped and returned as AddressResponse without saving to the repository in save(). This violates Reliability – Consistency and Functionality – Suitability, as the address is not persisted."
  },
  {
    "filename": "service/AddressServiceImpl.java",
    "start_line": 124,
    "end_line": 124,
    "severity": "high",
    "error_description": "Address entity is deleted without checking for referential integrity or handling related entities. This can cause data loss or orphaned records, violating Reliability – Recoverability and Integrity."
  },
  {
    "filename": "controller/UserController.java",
    "start_line": 58,
    "end_line": 60,
    "severity": "high",
    "error_description": "The delete() endpoint for users lacks any @PreAuthorize or security annotation, allowing any authenticated user to delete any user. This violates Security – Authorization and Confidentiality."
  },
  {
    "filename": "controller/AddressController.java",
    "start_line": 42,
    "end_line": 42,
    "severity": "high",
    "error_description": "@PostMapping for create() uses 'text/plain' as the consumes type, but expects a JSON AddressRequest. This causes deserialization errors and breaks Functionality – Interoperability and Reliability – Fault Tolerance."
  },
  {
    "filename": "mapper/UserMapper.java",
    "start_line": 56,
    "end_line": 56,
    "severity": "high",
    "error_description": "Password is double-encoded in updateUserEntityFromUserRequest() (passwordEncoder.encode(passwordEncoder.encode(dto.password()))), resulting in invalid hashes and breaking authentication. This violates Security – Confidentiality and Functionality – Suitability."
  },
  {
    "filename": "logging/LoggingConfig.java",
    "start_line": 51,
    "end_line": 52,
    "severity": "medium",
    "error_description": "The default log directory is hardcoded to an absolute path (/home/dbe/projects/llm-code-quality-experiment/baseline_project/logs), which breaks Portability and may cause startup failures on other systems."
  },
  {
    "filename": "logging/LoggingConfig.java",
    "start_line": 54,
    "end_line": 55,
    "severity": "medium",
    "error_description": "The default log file name contains a colon (application:errors.log), which is invalid on Windows and some filesystems. This breaks Portability and Reliability – Fault Tolerance."
  },
  {
    "filename": "logging/LoggingConfig.java",
    "start_line": 96,
    "end_line": 97,
    "severity": "medium",
    "error_description": "System.setProperty('user.timezone', 'UTC') and TimeZone.setDefault() are set globally, which can break other components expecting the system timezone. This violates Portability and Reliability – Interoperability."
  },
  {
    "filename": "logging/LoggingConfig.java",
    "start_line": 114,
    "end_line": 114,
    "severity": "medium",
    "error_description": "consoleEnabled is used with Objects.requireNonNullElseGet, but if the property is not set and profile is not 'dev', console logging may be disabled unintentionally, breaking Reliability – Operability."
  },
  {
    "filename": "security/SecurityConfig.java",
    "start_line": 107,
    "end_line": 110,
    "severity": "medium",
    "error_description": "createSecretKey() decodes the JWT secret from Base64 without validating its length or entropy. Weak or short secrets can compromise JWT security, violating Security – Confidentiality and Integrity."
  },
  {
    "filename": "mapper/AddressMapper.java",
    "start_line": 32,
    "end_line": 32,
    "severity": "medium",
    "error_description": "AddressRequest.someValue is mapped to Address.street, but the naming is inconsistent and may cause data mapping errors, violating Functionality – Suitability and Reliability – Consistency."
  },
  {
    "filename": "service/UserServiceImpl.java",
    "start_line": 80,
    "end_line": 80,
    "severity": "low",
    "error_description": "PageImpl is constructed with the full userResponses list and pageable, but the underlying repository is not paginated. This can cause performance issues and memory exhaustion on large datasets, violating Efficiency – Time Behavior and Resource Utilization."
  }
]