[
  {
    "filename": "com/llmquality/baseline/service/AddressServiceImpl.java",
    "start_line": 67,
    "end_line": 67,
    "severity": "critical",
    "error_description": "Unconditional call to Optional.get() on addressRepository.findById(addressId) without checking presence will throw NoSuchElementException if address is not found, resulting in 500 Internal Server Error instead of 404."
  },
  {
    "filename": "com/llmquality/baseline/service/AddressServiceImpl.java",
    "start_line": 87,
    "end_line": 88,
    "severity": "critical",
    "error_description": "Address entity is created from AddressRequest and User, but is never persisted to the database before mapping to AddressResponse. This results in the address not being saved and the returned response containing a null ID."
  },
  {
    "filename": "com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 103,
    "end_line": 104,
    "severity": "critical",
    "error_description": "Direct string concatenation of username into SQL in getByUsername creates a SQL injection vulnerability, allowing attackers to execute arbitrary SQL via the username parameter."
  },
  {
    "filename": "com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 182,
    "end_line": 183,
    "severity": "critical",
    "error_description": "Unconditional call to Optional.get() on userRepository.findByUsername(username) without checking presence will throw NoSuchElementException if user is not found, resulting in 500 Internal Server Error instead of 401 Unauthorized."
  },
  {
    "filename": "com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 119,
    "end_line": 119,
    "severity": "high",
    "error_description": "Sensitive user password is logged in plaintext in the save method, violating security best practices and risking credential leakage."
  },
  {
    "filename": "com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 126,
    "end_line": 127,
    "severity": "high",
    "error_description": "A new BCryptPasswordEncoder is instantiated locally for user creation, instead of using the injected PasswordEncoder bean, leading to inconsistent password encoding and potential authentication failures."
  },
  {
    "filename": "com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 153,
    "end_line": 154,
    "severity": "high",
    "error_description": "A new BCryptPasswordEncoder is instantiated locally for user update, instead of using the injected PasswordEncoder bean, leading to inconsistent password encoding and potential authentication failures."
  },
  {
    "filename": "com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 173,
    "end_line": 174,
    "severity": "medium",
    "error_description": "User entity is not actually deleted from the database in the delete method; only a debug log is written, resulting in a no-op and inconsistent system state."
  },
  {
    "filename": "com/llmquality/baseline/mapper/UserMapper.java",
    "start_line": 56,
    "end_line": 56,
    "severity": "high",
    "error_description": "Password is double-encoded in updateUserEntityFromUserRequest: passwordEncoder.encode(passwordEncoder.encode(dto.password())), resulting in an invalid hash and making user authentication impossible after update."
  },
  {
    "filename": "com/llmquality/baseline/controller/AddressController.java",
    "start_line": 42,
    "end_line": 46,
    "severity": "high",
    "error_description": "AddressController.create endpoint is mapped with consumes = 'text/plain', but expects a JSON AddressRequest object, causing deserialization errors and 415 Unsupported Media Type for valid JSON requests."
  },
  {
    "filename": "com/llmquality/baseline/controller/UserController.java",
    "start_line": 47,
    "end_line": 47,
    "severity": "medium",
    "error_description": "UserController.create does not validate the UserRequest object with @Valid or @Validated, allowing invalid or incomplete user data to be processed and saved."
  },
  {
    "filename": "com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 80,
    "end_line": 82,
    "severity": "medium",
    "error_description": "UserServiceImpl.listAll ignores the provided Pageable and always returns all users in a single page, breaking pagination and potentially causing performance issues with large datasets."
  },
  {
    "filename": "com/llmquality/baseline/service/AddressServiceImpl.java",
    "start_line": 68,
    "end_line": 68,
    "severity": "medium",
    "error_description": "No check for null or missing user in Address entity when enforcing ownership in getById; if address.getUser() is null, a NullPointerException may occur in enforceAddressOwnership."
  },
  {
    "filename": "com/llmquality/baseline/service/AddressServiceImpl.java",
    "start_line": 57,
    "end_line": 59,
    "severity": "medium",
    "error_description": "AddressServiceImpl.listAll maps Address entities to AddressResponse using addressMapper::toAddressResponse, but does not handle possible mapping failures or nulls, risking NullPointerException or incomplete data in the response."
  },
  {
    "filename": "com/llmquality/baseline/service/AddressServiceImpl.java",
    "start_line": 105,
    "end_line": 106,
    "severity": "medium",
    "error_description": "Address entity is updated via addressMapper.updateAddressEntityFromAddressRequest, but the returned entity is saved without checking for mapping errors or nulls, risking data loss or runtime exceptions."
  },
  {
    "filename": "com/llmquality/baseline/service/AddressServiceImpl.java",
    "start_line": 124,
    "end_line": 124,
    "severity": "medium",
    "error_description": "Address entity is deleted without checking for database errors or confirming successful deletion, risking silent failures and inconsistent state."
  },
  {
    "filename": "com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 104,
    "end_line": 104,
    "severity": "high",
    "error_description": "Direct use of entityManager.createNativeQuery with user input (username) without parameterization exposes the application to SQL injection attacks."
  },
  {
    "filename": "com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 180,
    "end_line": 180,
    "severity": "medium",
    "error_description": "Null password is replaced with empty string in checkLogin, but this may allow login attempts with blank passwords to be processed, potentially bypassing validation."
  },
  {
    "filename": "com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 184,
    "end_line": 185,
    "severity": "medium",
    "error_description": "Password comparison is performed even if user is null, but the hashed value is set to DUMMY_HASH, which may not match the password policy and could allow timing attacks."
  },
  {
    "filename": "com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 236,
    "end_line": 243,
    "severity": "medium",
    "error_description": "JWT 'scope' claim is set to Role.ADMIN.name() or Role.USER.name(), but JwtAuthenticationConverter expects 'scope' to be a space-delimited string of granted authorities (e.g., 'ROLE_ADMIN'), causing authorization mismatches."
  },
  {
    "filename": "com/llmquality/baseline/mapper/AddressMapper.java",
    "start_line": 31,
    "end_line": 31,
    "severity": "medium",
    "error_description": "AddressMapper.toAddressEntity maps AddressRequest.someValue to Address.street, but the field name 'someValue' is non-descriptive and may cause confusion or mapping errors if DTOs change."
  },
  {
    "filename": "com/llmquality/baseline/mapper/AddressMapper.java",
    "start_line": 58,
    "end_line": 58,
    "severity": "medium",
    "error_description": "AddressMapper.updateAddressEntityFromAddressRequest maps AddressRequest.someValue to Address.street, but does not update other fields, risking partial updates and inconsistent Address entities."
  },
  {
    "filename": "com/llmquality/baseline/dto/AddressRequest.java",
    "start_line": 23,
    "end_line": 23,
    "severity": "low",
    "error_description": "Field name 'someValue' in AddressRequest is non-descriptive and violates Clean Code naming conventions, reducing code readability and maintainability."
  },
  {
    "filename": "com/llmquality/baseline/dto/AddressRequest.java",
    "start_line": 22,
    "end_line": 22,
    "severity": "low",
    "error_description": "Validation message for 'someValue' is generic and does not help users understand what the field represents, reducing usability."
  },
  {
    "filename": "com/llmquality/baseline/mapper/UserMapper.java",
    "start_line": 27,
    "end_line": 27,
    "severity": "medium",
    "error_description": "UserMapper.toUserEntity uses passwordEncoder.encode(dto.password()) without checking for null password, risking NullPointerException if password is missing."
  },
  {
    "filename": "com/llmquality/baseline/mapper/UserMapper.java",
    "start_line": 35,
    "end_line": 35,
    "severity": "medium",
    "error_description": "UserMapper.toUserResponse exposes the 'admin' field as Boolean, which may be null if not set, risking NullPointerException or inconsistent API responses."
  },
  {
    "filename": "com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 237,
    "end_line": 243,
    "severity": "medium",
    "error_description": "JWT claims in generateJwtToken do not include standard 'authorities' or 'roles' claims, which may cause issues with downstream authorization checks."
  },
  {
    "filename": "com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 236,
    "end_line": 236,
    "severity": "low",
    "error_description": "Variable 'scope' is set to Role.ADMIN.name() or Role.USER.name(), but does not use the authority() method, leading to inconsistent role naming in JWT."
  },
  {
    "filename": "com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 119,
    "end_line": 119,
    "severity": "low",
    "error_description": "Logging user password in save method violates Clean Code and ISO 25010 security and maintainability guidelines."
  },
  {
    "filename": "com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 153,
    "end_line": 153,
    "severity": "low",
    "error_description": "Instantiating a new BCryptPasswordEncoder in update method instead of using the injected PasswordEncoder bean violates DRY and maintainability."
  },
  {
    "filename": "com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 126,
    "end_line": 126,
    "severity": "low",
    "error_description": "Instantiating a new BCryptPasswordEncoder in save method instead of using the injected PasswordEncoder bean violates DRY and maintainability."
  }
]