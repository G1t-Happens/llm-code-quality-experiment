[
  {
    "filename": "src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 103,
    "end_line": 104,
    "severity": "critical",
    "error_description": "SQL injection vulnerability: constructs SQL with unescaped user input (username) in getByUsername(). Allows arbitrary SQL execution, violating security (ISO 25010: Security, Integrity, Confidentiality)."
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 182,
    "end_line": 183,
    "severity": "critical",
    "error_description": "NullPointerException risk and authentication bypass: userRepository.findByUsername(username).get() is called without checking if user exists. If user is not found, NoSuchElementException is thrown, leaking existence of usernames and breaking login flow. Violates security and reliability."
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 119,
    "end_line": 127,
    "severity": "high",
    "error_description": "Password is hashed using a new BCryptPasswordEncoder instance instead of the injected PasswordEncoder, which may have different configuration (e.g., strength, salt). This can cause authentication failures and inconsistent password hashes, violating maintainability and security."
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 153,
    "end_line": 154,
    "severity": "high",
    "error_description": "Password is re-hashed using a new BCryptPasswordEncoder instance instead of the injected PasswordEncoder, leading to inconsistent password hashes and possible authentication failures. Violates maintainability and security."
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/mapper/UserMapper.java",
    "start_line": 55,
    "end_line": 56,
    "severity": "high",
    "error_description": "Password is double-encoded: passwordEncoder.encode(passwordEncoder.encode(dto.password())). This results in an invalid hash, making user authentication impossible. Violates functional correctness and security."
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/AddressServiceImpl.java",
    "start_line": 67,
    "end_line": 68,
    "severity": "high",
    "error_description": "AddressServiceImpl.getById() uses addressRepository.findById(addressId).get() without checking if the address exists, causing NoSuchElementException and leaking information about address existence. Violates reliability and security."
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/AddressServiceImpl.java",
    "start_line": 86,
    "end_line": 89,
    "severity": "high",
    "error_description": "Address entity is created but not persisted: addressRepository.save(addressEntity) is missing in save(). This causes the address not to be saved in the database, resulting in data loss and functional incompleteness."
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 164,
    "end_line": 174,
    "severity": "high",
    "error_description": "UserServiceImpl.delete() does not actually delete the user entity from the database. This results in a no-op, violating functional correctness and persistence (ISO 25010: Functional Suitability, Reliability)."
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/controller/AddressController.java",
    "start_line": 42,
    "end_line": 46,
    "severity": "high",
    "error_description": "AddressController.create() uses @PostMapping(consumes = \"text/plain\") instead of the standard \"application/json\". This breaks HTTP contract, causing clients to fail when sending JSON, violating interoperability and usability."
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/controller/UserController.java",
    "start_line": 58,
    "end_line": 60,
    "severity": "high",
    "error_description": "UserController.delete() endpoint is missing @PreAuthorize, allowing any authenticated user to delete any user account. This is a privilege escalation and security breach."
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 103,
    "end_line": 104,
    "severity": "high",
    "error_description": "Direct use of native SQL for user lookup in getByUsername() bypasses JPA and repository-level security, and disables automatic query parameterization, increasing risk of SQL injection and maintainability issues."
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/mapper/UserMapper.java",
    "start_line": 26,
    "end_line": 27,
    "severity": "medium",
    "error_description": "UserMapper.toUserEntity() hashes password even if null, which may result in encoding null and storing an invalid hash. Should check for null before encoding."
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/mapper/UserMapper.java",
    "start_line": 56,
    "end_line": 56,
    "severity": "medium",
    "error_description": "UserMapper.updateUserEntityFromUserRequest() double-encodes password, which is a major anti-pattern and breaks authentication. Also, does not check for null password before encoding."
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 75,
    "end_line": 80,
    "severity": "medium",
    "error_description": "UserServiceImpl.listAll() ignores pagination by fetching all users and then paginating in memory. This causes performance and scalability issues for large datasets, violating performance and resource utilization."
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 44,
    "end_line": 46,
    "severity": "low",
    "error_description": "DUMMY_HASH is hardcoded and may not match the actual password encoder configuration, reducing effectiveness of timing attack mitigation."
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 119,
    "end_line": 119,
    "severity": "low",
    "error_description": "Logging user passwords in plain text in save() exposes sensitive information in logs, violating confidentiality and security best practices."
  }
]