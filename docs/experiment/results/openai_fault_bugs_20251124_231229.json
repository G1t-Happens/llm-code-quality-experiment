[
  {
    "filename": "/home/dbe/projects/llm-quality-experiment/baseline_project/src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 102,
    "end_line": 104,
    "severity": "critical",
    "error_description": "SQL injection vulnerability: getByUsername() constructs SQL with unescaped user input (username) directly concatenated into query string. This is a nonmalicious development fault (design/implementation, software, internal, dormant until attacker supplies crafted username). High risk of erratic failure (data leak, privilege escalation, or data corruption)."
  },
  {
    "filename": "/home/dbe/projects/llm-quality-experiment/baseline_project/src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 181,
    "end_line": 189,
    "severity": "high",
    "error_description": "Null dereference and authentication bypass: checkLogin() calls userRepository.findByUsername(username).get() without checking if user is present, leading to NoSuchElementException if user does not exist. This is a nonmalicious development fault (omission, software, internal). Could cause halt failure (500 error) instead of proper 401 Unauthorized. Also, password check is performed after this dereference, so DUMMY_HASH is not used for non-existent users, undermining timing attack mitigation."
  },
  {
    "filename": "/home/dbe/projects/llm-quality-experiment/baseline_project/src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 125,
    "end_line": 126,
    "severity": "medium",
    "error_description": "Inconsistent password hashing: save() uses a new BCryptPasswordEncoder instance instead of the injected passwordEncoder, which may have different configuration (e.g., strength, salt). This is a nonmalicious development fault (implementation, software, internal). Could cause authentication failures or security inconsistencies."
  },
  {
    "filename": "/home/dbe/projects/llm-quality-experiment/baseline_project/src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 152,
    "end_line": 153,
    "severity": "medium",
    "error_description": "Inconsistent password hashing: update() uses a new BCryptPasswordEncoder instance instead of the injected passwordEncoder, which may have different configuration (e.g., strength, salt). This is a nonmalicious development fault (implementation, software, internal). Could cause authentication failures or security inconsistencies."
  },
  {
    "filename": "/home/dbe/projects/llm-quality-experiment/baseline_project/src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 163,
    "end_line": 173,
    "severity": "high",
    "error_description": "User deletion does not actually remove user from database: delete() loads user entity but does not call userRepository.delete() or equivalent. This is a nonmalicious development fault (omission, software, internal, dormant until delete endpoint is called). Could lead to content failure (users remain in DB despite delete request)."
  },
  {
    "filename": "/home/dbe/projects/llm-quality-experiment/baseline_project/src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 118,
    "end_line": 132,
    "severity": "low",
    "error_description": "Sensitive data exposure in logs: save() logs both username and password in plaintext at DEBUG level. This is a nonmalicious development fault (implementation, software, internal). Could lead to confidentiality failure if logs are accessed by unauthorized parties."
  },
  {
    "filename": "/home/dbe/projects/llm-quality-experiment/baseline_project/src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 136,
    "end_line": 159,
    "severity": "low",
    "error_description": "Sensitive data exposure in logs: update() logs username and potentially other sensitive fields at DEBUG level. This is a nonmalicious development fault (implementation, software, internal). Could lead to confidentiality failure if logs are accessed by unauthorized parties."
  },
  {
    "filename": "/home/dbe/projects/llm-quality-experiment/baseline_project/src/main/java/com/llmquality/baseline/mapper/UserMapper.java",
    "start_line": 55,
    "end_line": 55,
    "severity": "high",
    "error_description": "Password double-hashing: updateUserEntityFromUserRequest() hashes password as passwordEncoder.encode(passwordEncoder.encode(dto.password())), resulting in double hashing. This is a nonmalicious development fault (implementation, software, internal, dormant until password is updated). Could cause authentication failure (user cannot log in with new password)."
  },
  {
    "filename": "/home/dbe/projects/llm-quality-experiment/baseline_project/src/main/java/com/llmquality/baseline/service/AddressServiceImpl.java",
    "start_line": 67,
    "end_line": 67,
    "severity": "high",
    "error_description": "Unchecked Optional.get(): getById() calls addressRepository.findById(addressId).get() without checking if address exists, leading to NoSuchElementException if not found. This is a nonmalicious development fault (omission, software, internal). Could cause halt failure (500 error) instead of proper 404 Not Found."
  },
  {
    "filename": "/home/dbe/projects/llm-quality-experiment/baseline_project/src/main/java/com/llmquality/baseline/service/AddressServiceImpl.java",
    "start_line": 87,
    "end_line": 89,
    "severity": "high",
    "error_description": "Address entity not persisted: save() creates Address entity from DTO but does not persist it (missing addressRepository.save(addressEntity)). This is a nonmalicious development fault (omission, software, internal, dormant until address creation is attempted). Could cause content failure (address not saved in DB, but response returned as if it was)."
  }
]