[
  {
    "filename": "/home/dbe/projects/llm-code-quality-experiment/baseline_project/src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 103,
    "end_line": 104,
    "severity": "critical",
    "error_description": "SQL injection vulnerability: constructs SQL with unescaped user input (username) in getByUsername, allowing arbitrary SQL execution. Violates ISO 25010 Security (Integrity, Confidentiality) and Clean Code (never build SQL with user input)."
  },
  {
    "filename": "/home/dbe/projects/llm-code-quality-experiment/baseline_project/src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 182,
    "end_line": 183,
    "severity": "critical",
    "error_description": "NullPointerException risk and authentication bypass: userRepository.findByUsername(username).get() will throw if user not found, but DUMMY_HASH fallback is only used after. This allows crash (availability) and leaks timing info (security). Should use orElse(null) and check for null before password check."
  },
  {
    "filename": "/home/dbe/projects/llm-code-quality-experiment/baseline_project/src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 119,
    "end_line": 119,
    "severity": "high",
    "error_description": "Logs plaintext password in save() method, violating security (confidentiality) and Clean Code. Logging sensitive data is a major security breach."
  },
  {
    "filename": "/home/dbe/projects/llm-quality-experiment/baseline_project/src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 126,
    "end_line": 127,
    "severity": "high",
    "error_description": "Uses a new BCryptPasswordEncoder instance for hashing in save(), instead of the injected PasswordEncoder. This breaks consistency, may cause login failures, and violates DRY and maintainability."
  },
  {
    "filename": "/home/dbe/projects/llm-quality-experiment/baseline_project/src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 153,
    "end_line": 154,
    "severity": "high",
    "error_description": "Uses a new BCryptPasswordEncoder instance for hashing in update(), instead of the injected PasswordEncoder. This breaks consistency, may cause login failures, and violates DRY and maintainability."
  },
  {
    "filename": "/home/dbe/projects/llm-quality-experiment/baseline_project/src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 173,
    "end_line": 174,
    "severity": "high",
    "error_description": "User entity is not deleted in delete() method; only logs deletion. This causes data persistence loss and violates functional correctness and reliability."
  },
  {
    "filename": "/home/dbe/projects/llm-quality-experiment/baseline_project/src/main/java/com/llmquality/baseline/service/AddressServiceImpl.java",
    "start_line": 67,
    "end_line": 67,
    "severity": "high",
    "error_description": "Directly calls .get() on Optional from addressRepository.findById(addressId) in getById(), causing NoSuchElementException if not found. This results in 500 error instead of 404, violating reliability and HTTP contract."
  },
  {
    "filename": "/home/dbe/projects/llm-quality-experiment/baseline_project/src/main/java/com/llmquality/baseline/service/AddressServiceImpl.java",
    "start_line": 86,
    "end_line": 87,
    "severity": "high",
    "error_description": "Saves address entity but never persists it: addressMapper.toAddressEntity is called, but addressRepository.save is never invoked. Data is not persisted, violating functional correctness and reliability."
  },
  {
    "filename": "/home/dbe/projects/llm-quality-experiment/baseline_project/src/main/java/com/llmquality/baseline/controller/AddressController.java",
    "start_line": 42,
    "end_line": 42,
    "severity": "high",
    "error_description": "@PostMapping consumes = \"text/plain\" for create() endpoint, but expects JSON AddressRequest. This causes HTTP 415 errors and breaks API contract (functional suitability, usability, interoperability)."
  },
  {
    "filename": "/home/dbe/projects/llm-quality-experiment/baseline_project/src/main/java/com/llmquality/baseline/mapper/UserMapper.java",
    "start_line": 56,
    "end_line": 56,
    "severity": "high",
    "error_description": "Double-encoding of password in updateUserEntityFromUserRequest: passwordEncoder.encode(passwordEncoder.encode(dto.password())) will break authentication and cause data corruption. Violates functional correctness and maintainability."
  },
  {
    "filename": "/home/dbe/projects/llm-quality-experiment/baseline_project/src/main/java/com/llmquality/baseline/controller/UserController.java",
    "start_line": 58,
    "end_line": 60,
    "severity": "high",
    "error_description": "User delete endpoint lacks @PreAuthorize, allowing any authenticated user to delete any user. This is a privilege escalation and security breach (ISO 25010: Security, Integrity, Authenticity)."
  },
  {
    "filename": "/home/dbe/projects/llm-quality-experiment/baseline_project/src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 103,
    "end_line": 104,
    "severity": "high",
    "error_description": "Direct use of native SQL for user lookup in getByUsername, bypassing JPA and security controls. This is a major maintainability and security anti-pattern."
  },
  {
    "filename": "/home/dbe/projects/llm-quality-experiment/baseline_project/src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 80,
    "end_line": 80,
    "severity": "medium",
    "error_description": "Pagination is broken in listAll(): fetches all users, then pages in memory. This causes performance and scalability issues for large datasets (resource utilization, capacity)."
  },
  {
    "filename": "/home/dbe/projects/llm-quality-experiment/baseline_project/src/main/java/com/llmquality/baseline/logging/LoggingConfig.java",
    "start_line": 54,
    "end_line": 54,
    "severity": "medium",
    "error_description": "Default log file name contains a colon (application:errors.log), which is invalid on Windows and some filesystems. This breaks cross-platform compatibility (ISO 25010: Portability, Installability)."
  },
  {
    "filename": "/home/dbe/projects/llm-quality-experiment/baseline_project/src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 103,
    "end_line": 104,
    "severity": "medium",
    "error_description": "Bypasses repository method findByUsername in getByUsername, reducing maintainability and testability. Violates DRY and Clean Code."
  },
  {
    "filename": "/home/dbe/projects/llm-quality-experiment/baseline_project/src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 47,
    "end_line": 47,
    "severity": "low",
    "error_description": "DUMMY_HASH is not a valid bcrypt hash, which may cause timing differences and reduce effectiveness of timing attack mitigation. Should use a real bcrypt hash."
  }
]