[
  {
    "filename": "src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 163,
    "end_line": 174,
    "severity": "critical",
    "error_description": "Omission fault (development, human-made, nonmalicious): UserServiceImpl.delete(Long id) loads User entity via findById but omits repository.delete call, causing no actual DB deletion; dormant error activates on delete requests leading to integrity failure."
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/AddressServiceImpl.java",
    "start_line": 78,
    "end_line": 90,
    "severity": "critical",
    "error_description": "Omission fault (development, human-made, nonmalicious): AddressServiceImpl.save(Long userId, AddressRequest) creates Address entity but omits addressRepository.save, returning unsaved entity (null ID) as success response; leads to content failure."
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/mapper/UserMapper.java",
    "start_line": 55,
    "end_line": 55,
    "severity": "critical",
    "error_description": "Coding defect (development fault, human-made): updateUserEntityFromUserRequest mapper expression double-encodes password via passwordEncoder.encode(passwordEncoder.encode(dto.password())), corrupting hashes on updates; high-probability authentication failure propagation."
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 103,
    "end_line": 103,
    "severity": "critical",
    "error_description": "SQL injection vulnerability (interaction fault, human-made, operational): getByUsername crafts native query with direct username concatenation '\" + username + \"', enabling malicious input to alter SQL; high-risk data exposure or RCE."
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/AddressServiceImpl.java",
    "start_line": 67,
    "end_line": 67,
    "severity": "high",
    "error_description": "Unsafe Optional handling (software fault, omission): getById invokes .get() on findById without orElseThrow, causing NoSuchElementException runtime error instead of controlled ResourceNotFoundException; inconsistent error propagation."
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 75,
    "end_line": 80,
    "severity": "high",
    "error_description": "Scalability defect (design flaw): listAll(Pageable) fetches full List via findAll() then in-memory PageImpl pagination, risking OOM on large user tables; should use repository.findAll(pageable) for DB-level paging."
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/controller/UserController.java",
    "start_line": 59,
    "end_line": 62,
    "severity": "high",
    "error_description": "Authorization omission (security design fault): delete/{id} lacks @PreAuthorize; any authenticated user can invoke (service bug prevents actual delete but logs success); potential erratic behavior."
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 182,
    "end_line": 182,
    "severity": "medium",
    "error_description": "Error handling inconsistency (development fault): checkLogin .get() on findByUsername Optional throws NoSuchElementException for non-existent users instead of UnauthorizedException, aiding username enumeration attacks."
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 125,
    "end_line": 125,
    "severity": "medium",
    "error_description": "Resource management flaw: save creates ad-hoc BCryptPasswordEncoder() instead of injected field; risks encoding parameter mismatches across app (low prob. but latent compatibility fault)."
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/AddressServiceImpl.java",
    "start_line": 82,
    "end_line": 82,
    "severity": "low",
    "error_description": "Copy-paste defect: LOG.error in save uses incorrect message \"<-- getById\" instead of \"save\"; minor logging error but indicates sloppy development (incompetence fault)."
  }
]