{
  "_metadata": {
    "source_file": "session-ses_532e.md",
    "model": "grok.4.1.fast",
    "session_id": "ses_532e89049ffeyDrVPV4duLD6jf",
    "processed_at": "2025-11-29T01:54:54.067626",
    "bug_count": 14
  },
  "bugs": [
    {
      "filename": "src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
      "start_line": 102,
      "end_line": 103,
      "error_description": "SQL injection vulnerability: native SQL query constructed with direct string concatenation of user-provided 'username' parameter without parameterization"
    },
    {
      "filename": "src/main/java/com/llmquality/baseline/service/AddressServiceImpl.java",
      "start_line": 86,
      "end_line": 89,
      "error_description": "Missing repository.save(addressEntity) call; address is mapped to entity and response but never persisted to database, resulting in no data saved despite successful HTTP response"
    },
    {
      "filename": "src/main/java/com/llmquality/baseline/service/AddressServiceImpl.java",
      "start_line": 67,
      "end_line": 67,
      "error_description": "Unsafe use of Optional.get() without prior existence check; throws NoSuchElementException if address not found instead of proper ResourceNotFoundException"
    },
    {
      "filename": "src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
      "start_line": 81,
      "end_line": 82,
      "error_description": "Unsafe Optional.get() throws NoSuchElementException if user not found during login; prevents timing-attack protection as dummy hash comparison never reached; redundant null-check follows"
    },
    {
      "filename": "src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
      "start_line": 74,
      "end_line": 81,
      "error_description": "Incorrect pagination implementation loads entire user list into memory ignoring Pageable; inefficient for large datasets, manual PageImpl bypasses repository pagination"
    },
    {
      "filename": "src/main/java/com/llmquality/baseline/mapper/UserMapper.java",
      "start_line": 55,
      "end_line": 55,
      "error_description": "Double password encoding in update mapping expression: passwordEncoder.encode(passwordEncoder.encode(dto.password())); results in incorrectly hashed password"
    },
    {
      "filename": "src/main/java/com/llmquality/baseline/controller/UserController.java",
      "start_line": 59,
      "end_line": 62,
      "error_description": "Missing @PreAuthorize annotation on delete endpoint; lacks ownership or admin check, allows any authenticated user to delete any user"
    },
    {
      "filename": "src/main/java/com/llmquality/baseline/controller/UserController.java",
      "start_line": 49,
      "end_line": 49,
      "error_description": "Missing @Validated(UserValidationGroups.Create.class) on @RequestBody UserRequest parameter in create method; inconsistent with update method and validation groups defined"
    },
    {
      "filename": "src/main/java/com/llmquality/baseline/controller/AddressController.java",
      "start_line": 44,
      "end_line": 44,
      "error_description": "@PostMapping specifies consumes = \"text/plain\" incompatible with JSON DTO AddressRequest; prevents proper JSON request processing"
    },
    {
      "filename": "src/main/java/com/llmquality/baseline/controller/AddressController.java",
      "start_line": 12,
      "end_line": 20,
      "error_description": "Missing @Validated class annotation on controller; violates best practice for enabling method parameter validation consistently"
    },
    {
      "filename": "src/main/java/com/llmquality/baseline/controller/UserController.java",
      "start_line": 11,
      "end_line": 19,
      "error_description": "Missing @Validated class annotation on controller; violates best practice for enabling method parameter validation consistently"
    },
    {
      "filename": "src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
      "start_line": 100,
      "end_line": 113,
      "error_description": "getByUsername uses vulnerable native SQL instead of available repository.findByUsername method; redundant and insecure implementation"
    },
    {
      "filename": "src/main/java/com/llmquality/baseline/BaselineProjectApplication.java",
      "start_line": 8,
      "end_line": 8,
      "error_description": "Redundant @EnableMethodSecurity; already present in SecurityConfig.java, unnecessary duplication"
    },
    {
      "filename": "src/main/java/com/llmquality/baseline/security/SecurityConfig.java",
      "start_line": 48,
      "end_line": 48,
      "error_description": "Redundant @EnableMethodSecurity; already present in BaselineProjectApplication.java, unnecessary duplication"
    }
  ]
}