filename,det_lines,severity,description
AddressServiceImpl.java,"(97, 97)",high,"Unsafe use of .get() on Optional from findById in update method; assumes address exists without handling, leading to NoSuchElementException if not found rather than controlled exception."
AddressServiceImpl.java,"(117, 117)",high,Unsafe use of .get() on Optional from findById in delete method; throws unchecked NoSuchElementException on missing address instead of proper ResourceNotFoundException.
UserServiceImpl.java,"(236, 236)",medium,"Hardcoded role assignment in JWT generation; assumes binary admin/user without checking database roles, potentially issuing incorrect scopes if User entity admin flag is inconsistent with actual permissions."
SecurityConfig.java,"(82, 82)",high,"Misconfigured JWT authorities extraction; sets authoritiesClaimName to 'scope' but generates 'scope' as plain role name (e.g., 'ADMIN'), causing converter to extract without 'ROLE_' prefix, breaking @PreAuthorize role checks."
LoggingConfig.java,"(136, 136)",low,"Logging initialization failure not handled gracefully; if logging setup fails, error is logged via potentially uninitialized logger, leading to silent fallback without application notification."
UserRequest.java,"(22, 26)",medium,"Overly permissive password validation; @Size min=8 allows weak passwords despite pattern requiring complexity, but pattern on same field may cause validation conflicts or bypass if groups not applied correctly."
Address.java,"(17, 17)",medium,Lazy loading of User in Address entity without proper transaction management; potential LazyInitializationException if accessed outside session in service layer without @Transactional(readOnly=true) propagation.
AddressServiceImpl.java,"(140, 140)",medium,"Ownership check uses Objects.equals on potentially null ownerId; if user relation not loaded, compares null to requestedUserId, incorrectly allowing access or throwing unexpected NPE in logging."
build.gradle,"(26, 26)",low,Unnecessary security dependency for simple JWT setup; spring-boot-starter-security-oauth2-resource-server included but may introduce unused complexity without corresponding client auth configuration.
UserServiceImpl.java,"(103, 114)",high,"Bypass of JPA repository method; custom native query duplicates findByUsername functionality but introduces SQL injection risk, inconsistent parameterization, and potential performance issues without indexes."
