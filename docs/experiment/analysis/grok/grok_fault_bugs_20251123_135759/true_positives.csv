gt_id,filename,gt_lines,det_lines,severity_gt,severity_det,gt_description,det_description
E014,UserServiceImpl.java,"(103, 109)","(103, 103)",critical,critical,"Username parameter is concatenated directly into SQL, allowing an attacker to retrieve data via SQL injections","Direct string concatenation in native SQL query creates SQL injection vulnerability; user-controlled 'username' parameter is not parameterized, allowing malicious input to alter query structure and potentially extract or modify database contents."
E011,UserServiceImpl.java,"(182, 182)","(182, 182)",critical,high,Calling .get() on findByUsername() causes a NoSuchElementException (HTTP 500) on every login attempt with a non-existent username instead of returning the intended HTTP 401 Unauthorized,"Unsafe use of .get() on Optional from findByUsername without null check; if user not found, this throws NoSuchElementException instead of handling gracefully with ResourceNotFoundException, leading to unhandled runtime exception and potential information disclosure."
E006,UserServiceImpl.java,"(153, 153)","(154, 154)",medium,high,PasswordEncoder created per request rather than as a singleton,"Incorrect double-hashing in updateUserEntityFromUserRequest mapping expression; password is encoded twice with passwordEncoder.encode(passwordEncoder.encode(dto.password())), resulting in invalid hash that fails future authentication matches."
E005,UserServiceImpl.java,"(126, 126)","(126, 126)",medium,medium,PasswordEncoder created per request rather than as a singleton,"Redundant instantiation of BCryptPasswordEncoder in save method; class already injects PasswordEncoder bean, creating unnecessary new instance leads to potential inconsistency if different strength parameters are used."
E002,UserServiceImpl.java,"(164, 174)","(164, 164)",critical,medium,Missing delete call in the repository/data access layer,"Missing implementation of user deletion; delete method loads user but performs no actual deletion via repository.delete(), leaving entities in database and causing silent failures in delete operations."
E013,AddressServiceImpl.java,"(68, 68)","(68, 68)",critical,high,Replacing .orElseThrow() with .get() in AddressServiceImpl.getById() causes an unhandled NoSuchElementException and returns HTTP 500 instead of the proper HTTP 404 whenever a client requests a non-existent address ID,"Unsafe use of .get() on Optional from findById without null check; if address not found, throws NoSuchElementException instead of ResourceNotFoundException, bypassing proper error handling and HTTP 404 response."
E003,AddressServiceImpl.java,"(79, 91)","(87, 87)",critical,medium,Missing save call in the repository/data access layer,"Potential NullPointerException in save method; addressMapper.toAddressEntity called without saving the returned entity to repository, so addressResponse maps from unsaved entity with null ID, returning invalid response."
E016,UserController.java,"(57, 58)","(58, 58)",critical,high,"Removing @PreAuthorize(admin) from the user deletion endpoint allows any authenticated user to permanently delete any account, including all administrators, leading to immediate and irreversible loss of system ownership","Missing @PreAuthorize annotation on delete endpoint; allows unauthenticated or unauthorized users to delete any user by ID, violating security model and enabling unauthorized data deletion."
E009,AddressController.java,"(42, 42)","(42, 42)",high,medium,Incorrect MIME type in controller. The API expects JSON but text/plain is declared. Clients sending JSON may fail,"Inconsistent media type handling; @PostMapping consumes 'text/plain' instead of standard 'application/json', potentially causing parsing failures or security issues with unexpected content types."
E001,UserMapper.java,"(55, 55)","(55, 55)",medium,critical,Double encryption of the password using a password encoder,"Incorrect password update logic in mapper; expression double-encodes password and fails to properly handle null checks, leading to broken authentication after updates due to invalid hash format."
E004,UserServiceImpl.java,"(75, 80)","(75, 81)",high,medium,Loading all users before pagination and transform them to DTOs â€“ wrong order,"Inefficient pagination in listAll; loads all users into memory with findAll() then manually creates PageImpl, causing high memory usage and performance degradation for large datasets instead of using repository paging."
E010,UserController.java,"(47, 47)","(45, 45)",high,low,"The create() endpoint does not validate the UserRequest DTO. Invalid input (e.g., missing required fields) can lead to a 500 Internal Server Error instead of a clear client-facing error","Missing validation group specification on create endpoint; @RequestBody UserRequest lacks @Validated(Create.class), potentially allowing update-only validations or bypassing required field checks."
