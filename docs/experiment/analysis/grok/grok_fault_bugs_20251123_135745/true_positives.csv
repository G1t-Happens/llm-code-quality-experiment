gt_id,filename,gt_lines,det_lines,severity_gt,severity_det,gt_description,det_description
E014,UserServiceImpl.java,"(103, 109)","(103, 103)",critical,critical,"Username parameter is concatenated directly into SQL, allowing an attacker to retrieve data via SQL injections","Direct string concatenation in native SQL query creates SQL injection vulnerability; user-controlled 'username' parameter is not parameterized, allowing malicious input to alter query structure and potentially extract or modify database contents."
E005,UserServiceImpl.java,"(126, 126)","(127, 127)",medium,high,PasswordEncoder created per request rather than as a singleton,"Redundant instantiation of BCryptPasswordEncoder inside save() method; creates new encoder instance per operation instead of using injected dependency, leading to inconsistent hashing parameters and potential security inconsistencies across operations."
E006,UserServiceImpl.java,"(153, 153)","(153, 153)",medium,high,PasswordEncoder created per request rather than as a singleton,"Redundant BCryptPasswordEncoder instantiation in update() method; similar to save(), this creates a new instance per update, causing potential hashing inconsistencies and unnecessary performance overhead."
E011,UserServiceImpl.java,"(182, 182)","(182, 182)",critical,medium,Calling .get() on findByUsername() causes a NoSuchElementException (HTTP 500) on every login attempt with a non-existent username instead of returning the intended HTTP 401 Unauthorized,"Unsafe use of .get() on Optional from findByUsername(); assumes user always exists without null check, which contradicts the method's purpose of finding by username and could lead to NoSuchElementException if user not found."
E013,AddressServiceImpl.java,"(68, 68)","(68, 68)",critical,high,Replacing .orElseThrow() with .get() in AddressServiceImpl.getById() causes an unhandled NoSuchElementException and returns HTTP 500 instead of the proper HTTP 404 whenever a client requests a non-existent address ID,"Unsafe use of .get() on Optional from findById(); assumes address always exists, leading to NoSuchElementException if address not found, bypassing proper error handling via orElseThrow() used elsewhere in the class."
E003,AddressServiceImpl.java,"(79, 91)","(87, 87)",critical,medium,Missing save call in the repository/data access layer,"Potential transaction boundary issue in save(); maps to entity and immediately to response without saving to database first, returning unsaved entity ID which could be null or inconsistent if transaction fails."
E001,UserMapper.java,"(55, 55)","(55, 55)",medium,critical,Double encryption of the password using a password encoder,"Double-hashing vulnerability in update mapping; expression applies passwordEncoder.encode() twice on dto.password(), resulting in incorrectly hashed passwords that won't match during login authentication."
E016,UserController.java,"(57, 58)","(58, 58)",critical,high,"Removing @PreAuthorize(admin) from the user deletion endpoint allows any authenticated user to permanently delete any account, including all administrators, leading to immediate and irreversible loss of system ownership","Missing @PreAuthorize annotation on delete endpoint; allows unauthenticated or unauthorized users to delete any user by ID, violating security model where other operations require admin or owner checks."
E009,AddressController.java,"(42, 42)","(42, 42)",high,low,Incorrect MIME type in controller. The API expects JSON but text/plain is declared. Clients sending JSON may fail,"Unusual consumes='text/plain' on POST mapping; while functional for JSON, this restricts content type unnecessarily and may confuse API clients expecting standard application/json for REST endpoints."
E008,LoggingConfig.java,"(96, 97)","(99, 99)",high,medium,"Sets the timezone globally for the entire JVM instead of only for the logger, potentially affecting other modules, libraries, and scheduling operations","Hardcoded UTC timezone setting; overrides system timezone without configuration option, which may cause timestamp inconsistencies in international deployments or when system timezone is intentionally set differently."
E010,UserController.java,"(47, 47)","(47, 47)",high,medium,"The create() endpoint does not validate the UserRequest DTO. Invalid input (e.g., missing required fields) can lead to a 500 Internal Server Error instead of a clear client-facing error","Missing validation group specification in create endpoint; @RequestBody UserRequest lacks @Validated(Create.class), potentially allowing update-only validations to bypass required field checks during creation."
E004,UserServiceImpl.java,"(75, 80)","(75, 81)",high,low,Loading all users before pagination and transform them to DTOs â€“ wrong order,"Inefficient pagination in listAll; loads all users into memory via findAll() then creates PageImpl, unsuitable for large datasets as it ignores pageable offset/limit at database level, causing performance degradation."
