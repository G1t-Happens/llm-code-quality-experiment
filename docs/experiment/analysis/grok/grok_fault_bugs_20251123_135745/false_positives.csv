filename,det_lines,severity,description
UserServiceImpl.java,"(55, 55)",medium,"Unnecessary EntityManager injection; while used for native query, this bypasses JPA repository methods and introduces maintenance complexity without clear benefits over parameterized repository queries."
AddressServiceImpl.java,"(97, 97)",high,"Inconsistent error handling in update(); uses orElseThrow() correctly here, but contrasts with getById() method's unsafe .get(), creating uneven fault tolerance across similar operations."
AddressServiceImpl.java,"(117, 117)",high,"Unsafe .get() usage in delete() method; similar to getById(), this assumes address existence without proper Optional handling, risking runtime exception on missing resources."
build.gradle,"(26, 26)",medium,"Inclusion of spring-boot-starter-security without explicit configuration for production; default security may interfere with custom JWT setup, potentially causing authentication conflicts in operational phase."
SecurityConfig.java,"(65, 65)",high,"PermitAll on POST /users allows unauthenticated user creation; while intentional for registration, lacks rate limiting or CAPTCHA integration, enabling potential denial-of-service or spam account creation."
UserServiceImpl.java,"(147, 150)",medium,"Incomplete uniqueness check in update(); only checks if new username exists and differs from current, but does not handle case-insensitivity or whitespace normalization, potentially allowing duplicate usernames."
Address.java,"(17, 17)",medium,"LAZY fetch on mandatory User relationship; while efficient, risks LazyInitializationException if address is accessed outside transaction without proper Open Session in View or eager loading strategy."
AddressServiceImpl.java,"(142, 142)",high,"Null pointer risk in enforceAddressOwnership; accesses address.getUser().getId() without checking if user is null, despite @ManyToOne(optional=false), but LAZY fetch could cause issues if not initialized."
UserServiceImpl.java,"(236, 236)",low,"Hardcoded Role.USER fallback in JWT generation; assumes non-admin users get USER role, but entity only has admin boolean without explicit role enum mapping, potentially misaligning with security expectations."
SecurityExpressions.java,"(19, 19)",medium,"String conversion in isOwner check; compares resourceOwnerId.toString() with auth.getName() assuming username is numeric ID, but auth.getName() is 'sub' claim (user ID as string), which is consistent but brittle if claim changes."
