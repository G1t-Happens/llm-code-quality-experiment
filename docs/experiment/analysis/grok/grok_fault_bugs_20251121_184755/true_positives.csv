gt_id,filename,gt_lines,det_lines,severity_gt,severity_det,gt_description,det_description
E016,UserServiceImpl.java,"(103, 109)","(103, 103)",critical,critical,"Username parameter is concatenated directly into SQL, allowing an attacker to retrieve data via SQL injections","Direct string concatenation in native SQL query enables SQL injection vulnerability, allowing arbitrary database access and data manipulation (Security: injection, Integrity violation per ISO 25010)"
E013,UserServiceImpl.java,"(182, 182)","(182, 182)",critical,high,Calling .get() on findByUsername() causes a NoSuchElementException (HTTP 500) on every login attempt with a non-existent username instead of returning the intended HTTP 401 Unauthorized,"NullPointerException risk when userRepository.findByUsername(username) returns empty Optional and .get() is called without check, causing application crash during login (Reliability: Fault tolerance, Availability failure)"
E015,AddressServiceImpl.java,"(65, 65)","(67, 67)",critical,high,Replacing .orElseThrow() with .get() in AddressServiceImpl.getById() causes an unhandled NoSuchElementException and returns HTTP 500 instead of the proper HTTP 404 whenever a client requests a non-existent address ID,"NullPointerException risk when addressRepository.findById(addressId) returns empty Optional and .get() is called without check, causing application crash during address retrieval (Reliability: Fault tolerance, Availability failure)"
E001,UserMapper.java,"(56, 56)","(55, 56)",medium,high,Double encryption of the password using a password encoder,"Double password hashing in update mapping (passwordEncoder.encode(passwordEncoder.encode(...))) creates unusable password hashes, breaking authentication and causing login failures (Security: Authenticity, Integrity violation)"
E018,UserController.java,"(57, 58)","(57, 60)",critical,high,"Removing @PreAuthorize(admin) from the user deletion endpoint allows any authenticated user to permanently delete any account, including all administrators, leading to immediate and irreversible loss of system ownership","DELETE /users/{id} endpoint lacks @PreAuthorize security annotation, allowing unauthorized users to delete any user record and causing data loss (Security: Access control, Integrity violation)"
E011,AddressRequest.java,"(23, 23)","(19, 22)",low,medium,someValue field in AddressRequest is ambiguous and does not clearly indicate its purpose. Frontend developers not know which data to provide,"Placeholder field 'someValue' with misleading validation messages ('House number is required') violates Clean Code naming and SRP principles, causing client confusion and incorrect data mapping to entity street field (Usability: Learnability, Maintainability: Analysability)"
E005,UserServiceImpl.java,"(126, 126)","(126, 126)",medium,medium,PasswordEncoder created per request rather than as a singleton,"Local BCryptPasswordEncoder instantiation in save() bypasses Spring-managed bean, potentially causing inconsistent hashing strength/configuration and authentication inconsistencies (Maintainability: Reusability, Compatibility: Interoperability)"
E006,UserServiceImpl.java,"(153, 153)","(153, 153)",medium,medium,PasswordEncoder created per request rather than as a singleton,"Local BCryptPasswordEncoder instantiation in update() bypasses Spring-managed bean, potentially causing inconsistent hashing strength/configuration and authentication inconsistencies (Maintainability: Reusability, Compatibility: Interoperability)"
E020,AddressServiceImpl.java,"(35, 35)","(36, 36)",medium,low,"Using @Autowired field injection instead of constructor injection reduces testability, hides dependencies, and makes the class harder to instantiate manually or refactor","Unused @Autowired UserRepository field violates Clean Code DRY principle and reduces maintainability, as the dependency is already injected via constructor (Maintainability: Modularity, Analysability)"
