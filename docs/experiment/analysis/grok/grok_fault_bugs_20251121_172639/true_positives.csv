gt_id,filename,gt_lines,det_lines,severity_gt,severity_det,gt_description,det_description
E016,UserServiceImpl.java,"(103, 109)","(103, 103)",critical,critical,"Username parameter is concatenated directly into SQL, allowing an attacker to retrieve data via SQL injections","Direct string concatenation in native SQL query enables SQL injection vulnerability, allowing arbitrary database access and data exfiltration (Security: injection, Confidentiality, Integrity)"
E005,UserServiceImpl.java,"(126, 126)","(127, 127)",medium,high,PasswordEncoder created per request rather than as a singleton,"Redundant instantiation of BCryptPasswordEncoder inside service method creates new encoder per operation, breaking password verification consistency and enabling auth bypass (Security: Authenticity, Integrity)"
E006,UserServiceImpl.java,"(153, 153)","(154, 154)",medium,high,PasswordEncoder created per request rather than as a singleton,"Double-hashing password in update mapper expression (passwordEncoder.encode(passwordEncoder.encode(...))) corrupts password storage, causing all future logins to fail (Security: Integrity, Authenticity)"
E015,AddressServiceImpl.java,"(65, 65)","(67, 67)",critical,high,Replacing .orElseThrow() with .get() in AddressServiceImpl.getById() causes an unhandled NoSuchElementException and returns HTTP 500 instead of the proper HTTP 404 whenever a client requests a non-existent address ID,"Unwrapped .get() on Optional from repository without null check causes NullPointerException crash when address not found, violating fault tolerance (Reliability: Fault tolerance, Availability)"
E013,UserServiceImpl.java,"(182, 182)","(182, 182)",critical,high,Calling .get() on findByUsername() causes a NoSuchElementException (HTTP 500) on every login attempt with a non-existent username instead of returning the intended HTTP 401 Unauthorized,"Unwrapped .get() on Optional from findByUsername without null check causes NullPointerException crash when user not found during login, breaking authentication availability (Reliability: Availability, Fault tolerance)"
E011,AddressRequest.java,"(23, 23)","(19, 22)",low,medium,someValue field in AddressRequest is ambiguous and does not clearly indicate its purpose. Frontend developers not know which data to provide,"Placeholder field 'someValue' with misleading validation messages violates naming and functional correctness, causing client confusion and data mapping errors (Maintainability: Analysability, Usability: Learnability)"
E004,UserServiceImpl.java,"(75, 80)","(75, 81)",high,medium,Loading all users before pagination and transform them to DTOs â€“ wrong order,"Manual pagination implementation ignores Spring Data's Pageable sorting and ignores actual repository paging, returning incorrect or incomplete results (Functional suitability: Functional completeness, Compatibility: Interoperability)"
E018,UserController.java,"(57, 58)","(58, 58)",critical,medium,"Removing @PreAuthorize(admin) from the user deletion endpoint allows any authenticated user to permanently delete any account, including all administrators, leading to immediate and irreversible loss of system ownership","Missing @PreAuthorize on delete endpoint allows unauthorized user deletion, violating access control and enabling privilege escalation (Security: Access control, Authenticity)"
E003,AddressServiceImpl.java,"(76, 88)","(87, 87)",critical,low,Missing save call in the repository/data access layer,"Mapping to new Address entity but returning response from unmapped entity causes ID mismatch in response, breaking HTTP contract consistency (Usability: User error protection, Compatibility: Co-existence)"
E020,AddressServiceImpl.java,"(35, 35)","(36, 36)",medium,low,"Using @Autowired field injection instead of constructor injection reduces testability, hides dependencies, and makes the class harder to instantiate manually or refactor","Field injection via @Autowired on UserRepository violates dependency injection best practices and constructor injection preference (Maintainability: Modularity, Testability)"
