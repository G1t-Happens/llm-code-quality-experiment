gt_id,filename,gt_lines,det_lines,severity_gt,severity_det,gt_description,det_description
E016,UserServiceImpl.java,"(103, 109)","(103, 104)",critical,high,"Username parameter is concatenated directly into SQL, allowing an attacker to retrieve data via SQL injections","SQL injection vulnerability by concatenating untrusted 'username' into a native query. Allows malicious input to alter the query, breaching confidentiality/integrity (ISO 25010: Security - Injection). Use parameterized queries or repository methods instead."
E013,UserServiceImpl.java,"(182, 182)","(182, 189)",critical,high,Calling .get() on findByUsername() causes a NoSuchElementException (HTTP 500) on every login attempt with a non-existent username instead of returning the intended HTTP 401 Unauthorized,"Unchecked Optional.get() on findByUsername causes NoSuchElementException for unknown users, returning 500 instead of 401 and defeating constant-time mitigation. Breaks reliability and correct HTTP semantics for /login (ISO 25010: Functional correctness, Reliability)."
E001,UserMapper.java,"(56, 56)","(56, 57)",medium,high,Double encryption of the password using a password encoder,"Passwords are double-encoded during update (BCrypt over BCrypt), making subsequent logins impossible. Violates data integrity and functional correctness; must encode raw password exactly once."
E003,AddressServiceImpl.java,"(76, 88)","(86, 90)",critical,high,Missing save call in the repository/data access layer,"Address is never persisted in save(); returns a DTO mapped from an unsaved entity (null ID). Causes data loss and inconsistent API behavior (ISO 25010: Functional completeness/correctness, Persistence). Must call addressRepository.save(entity) before mapping."
E009,AddressController.java,"(42, 42)","(42, 46)",high,high,Incorrect MIME type in controller. The API expects JSON but text/plain is declared. Clients sending JSON may fail,"create endpoint declares consumes='text/plain' but expects JSON AddressRequest. Causes 415 Unsupported Media Type and breaks REST contract (ISO 25010: Compatibility/Interoperability, Functional correctness). Should consume application/json."
E018,UserController.java,"(57, 58)","(57, 60)",critical,high,"Removing @PreAuthorize(admin) from the user deletion endpoint allows any authenticated user to permanently delete any account, including all administrators, leading to immediate and irreversible loss of system ownership",DELETE /users/{id} lacks authorization guard (@PreAuthorize). Any authenticated user can delete arbitrary users (authorization bypass). Severe security breach (ISO 25010: Security - Access control).
E015,AddressServiceImpl.java,"(65, 65)","(67, 67)",critical,high,Replacing .orElseThrow() with .get() in AddressServiceImpl.getById() causes an unhandled NoSuchElementException and returns HTTP 500 instead of the proper HTTP 404 whenever a client requests a non-existent address ID,"Use of Optional.get() on addressRepository.findById causes 500 instead of 404 when address not found. Violates correct HTTP semantics and reduces fault tolerance (ISO 25010: Reliability, Functional correctness). Should throw ResourceNotFoundException on empty."
E002,UserServiceImpl.java,"(164, 174)","(166, 174)",critical,high,Missing delete call in the repository/data access layer,"delete() never invokes userRepository.delete(...). Endpoint reports success without deleting, causing functional inconsistency and potential security issues (e.g., expecting account removal)."
E004,UserServiceImpl.java,"(75, 80)","(75, 81)",high,high,Loading all users before pagination and transform them to DTOs â€“ wrong order,"listAll ignores pagination and loads all users into memory, then returns the entire list in the page. Breaks functional contract and degrades performance/capacity (ISO 25010: Performance efficiency, Functional correctness). Must use repository paging."
E010,UserController.java,"(47, 47)","(45, 49)",high,high,"The create() endpoint does not validate the UserRequest DTO. Invalid input (e.g., missing required fields) can lead to a 500 Internal Server Error instead of a clear client-facing error","Create user endpoint lacks @Validated(Create.class)/@Valid on request body, so required constraints (username/password/email) are not enforced. Allows creation of invalid users (integrity/validation failure; ISO 25010: Functional correctness, Security - Input validation)."
E017,UserServiceImpl.java,"(119, 119)","(120, 120)",critical,high,"Logs include user passwords in plaintext, potentially exposing them in logs accessible to operators or attackers",Sensitive data exposure: logs plaintext password during user creation. Violates confidentiality and audit best practices (ISO 25010: Security). Remove secret logging.
E022,LoggingConfig.java,"(54, 55)","(55, 55)",high,medium,"The default log file name contains characters valid on Linux but invalid on Windows (e.g., application:errors.log). This prevents installation/running on Windows","Default log file name contains ':' (application:errors.log), invalid on Windows and some filesystems, causing logging failure or degraded diagnostics (ISO 25010: Portability/Reliability). Use a cross-platform file name (e.g., application-errors.log)."
E023,LoggingConfig.java,"(51, 52)","(51, 51)",high,medium,Hardcoded Linux-specific log directory. Running this on Windows or another OS will fail or move to an unpredictable location unless manually changed,"Default log directory points to a developer-specific absolute path. On hosts without permissions, initialization falls back after error; leads to fragile, environment-dependent behavior (ISO 25010: Portability/Reliability). Use relative/OS-appropriate defaults."
E005,UserServiceImpl.java,"(126, 126)","(126, 128)",medium,medium,PasswordEncoder created per request rather than as a singleton,Inconsistent password hashing: creates a new BCryptPasswordEncoder instead of using the injected bean. Complicates future encoder migrations and testing (ISO 25010: Maintainability). Use the configured PasswordEncoder bean consistently.
