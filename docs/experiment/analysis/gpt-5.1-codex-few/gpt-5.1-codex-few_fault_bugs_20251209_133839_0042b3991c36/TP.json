[
  {
    "filename": "src/main/java/com/llmquality/baseline/controller/UserController.java",
    "start_line": 59,
    "end_line": 61,
    "error_description": "Delete user endpoint lacks any @PreAuthorize rule, so any authenticated user can delete arbitrary users, bypassing the owner/admin checks enforced elsewhere.",
    "confidence": 0.78,
    "semantically_correct_detected": "E015",
    "similarity_score": 0.7894,
    "matching_method": "per_run_basename_overlap_best_semantic"
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/AddressServiceImpl.java",
    "start_line": 65,
    "end_line": 74,
    "error_description": "getById uses Optional.get() without presence check. When an address ID does not exist it throws NoSuchElementException (500) instead of the intended ResourceNotFoundException (404).",
    "confidence": 0.72,
    "semantically_correct_detected": "E012",
    "similarity_score": 0.754,
    "matching_method": "per_run_basename_overlap_best_semantic"
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 99,
    "end_line": 107,
    "error_description": "getByUsername builds a native SQL string with the raw username (\"... WHERE username = '\" + username + \"'\"). An attacker can inject SQL via the username parameter, leading to SQL injection.",
    "confidence": 0.84,
    "semantically_correct_detected": "E013",
    "similarity_score": 0.7432,
    "matching_method": "per_run_basename_overlap_best_semantic"
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/controller/UserController.java",
    "start_line": 47,
    "end_line": 51,
    "error_description": "The user creation endpoint does not apply any bean validation (@Validated(Create.class)), letting malformed usernames/passwords/emails through even though the DTO defines constraints.",
    "confidence": 0.64,
    "semantically_correct_detected": "E008",
    "similarity_score": 0.6401,
    "matching_method": "per_run_basename_overlap_best_semantic"
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 161,
    "end_line": 173,
    "error_description": "delete() fetches the user but never calls userRepository.delete, so no user is actually removed despite returning success.",
    "confidence": 0.85,
    "semantically_correct_detected": "E002",
    "similarity_score": 0.5869,
    "matching_method": "per_run_basename_overlap_best_semantic"
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/AddressServiceImpl.java",
    "start_line": 76,
    "end_line": 89,
    "error_description": "save() maps the DTO to an entity and immediately back to a response without persisting it via addressRepository.save, so no address is stored and the returned DTO lacks the generated ID.",
    "confidence": 0.82,
    "semantically_correct_detected": "E003",
    "similarity_score": 0.5776,
    "matching_method": "per_run_basename_overlap_best_semantic"
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 175,
    "end_line": 189,
    "error_description": "checkLogin calls userRepository.findByUsername(...).get() and later checks if user==null. When the user is absent it throws NoSuchElementException instead of returning Unauthorized, defeating the dummy-hash timing protection and breaking login error handling.",
    "confidence": 0.8,
    "semantically_correct_detected": "E010",
    "similarity_score": 0.5724,
    "matching_method": "per_run_basename_overlap_best_semantic"
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/controller/AddressController.java",
    "start_line": 50,
    "end_line": 53,
    "error_description": "The PATCH endpoint does not validate the incoming AddressRequest (missing @Validated(Update.class)), so invalid or blank fields bypass bean validation and can be persisted.",
    "confidence": 0.63,
    "semantically_correct_detected": "E009",
    "similarity_score": 0.5512,
    "matching_method": "per_run_basename_overlap_best_semantic"
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 72,
    "end_line": 81,
    "error_description": "listAll ignores the Pageable parameter, loads all users, and wraps them in a PageImpl. Requested page/size are never applied, producing incorrect pagination and unnecessary memory usage.",
    "confidence": 0.56,
    "semantically_correct_detected": "E004",
    "similarity_score": 0.5432,
    "matching_method": "per_run_basename_overlap_best_semantic"
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 117,
    "end_line": 131,
    "error_description": "save() logs the supplied password in plaintext (\"user with name ... and password ...\"), leaking credentials to application logs.",
    "confidence": 0.77,
    "semantically_correct_detected": "E014",
    "similarity_score": 0.5389,
    "matching_method": "per_run_basename_overlap_best_semantic"
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/controller/AddressController.java",
    "start_line": 44,
    "end_line": 48,
    "error_description": "The create endpoint is declared with consumes=\"text/plain\" while it expects a JSON body. Any client posting the usual application/json payload will be rejected with HTTP 415, preventing address creation.",
    "confidence": 0.61,
    "semantically_correct_detected": "E007",
    "similarity_score": 0.448,
    "matching_method": "per_run_basename_overlap_best_semantic"
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/mapper/UserMapper.java",
    "start_line": 55,
    "end_line": 55,
    "error_description": "updateUserEntityFromUserRequest encodes the password twice (passwordEncoder.encode(passwordEncoder.encode(...))). The resulting hash cannot match login attempts, effectively locking users out after password updates.",
    "confidence": 0.8,
    "semantically_correct_detected": "E001",
    "similarity_score": 0.334,
    "matching_method": "per_run_basename_overlap_best_semantic"
  }
]