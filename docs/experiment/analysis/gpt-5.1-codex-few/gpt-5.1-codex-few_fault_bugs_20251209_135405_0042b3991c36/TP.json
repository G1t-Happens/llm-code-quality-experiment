[
  {
    "filename": "src/main/java/com/llmquality/baseline/service/AddressServiceImpl.java",
    "start_line": 64,
    "end_line": 74,
    "error_description": "getById calls addressRepository.findById(addressId).get() without handling the empty Optional, which throws NoSuchElementException and returns HTTP 500 instead of the intended ResourceNotFoundException when an address does not exist.",
    "confidence": 0.81,
    "semantically_correct_detected": "E012",
    "similarity_score": 0.7803,
    "matching_method": "per_run_basename_overlap_best_semantic"
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/controller/UserController.java",
    "start_line": 59,
    "end_line": 62,
    "error_description": "The delete endpoint lacks any @PreAuthorize check, so every authenticated user can delete arbitrary users instead of restricting the operation to admins/owners like the other endpoints.",
    "confidence": 0.66,
    "semantically_correct_detected": "E015",
    "similarity_score": 0.7515,
    "matching_method": "per_run_basename_overlap_best_semantic"
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/controller/AddressController.java",
    "start_line": 50,
    "end_line": 54,
    "error_description": "The update endpoint accepts AddressRequest bodies without any validation group, so Update-specific constraints (e.g., non-empty fields) are never enforced and invalid data reaches the service layer unchecked.",
    "confidence": 0.58,
    "semantically_correct_detected": "E009",
    "similarity_score": 0.7301,
    "matching_method": "per_run_basename_overlap_best_semantic"
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/controller/UserController.java",
    "start_line": 47,
    "end_line": 51,
    "error_description": "The create endpoint does not annotate the UserRequest parameter with @Valid/@Validated(Create.class), allowing requests with blank usernames/passwords/emails or invalid formats to bypass all validation rules.",
    "confidence": 0.63,
    "semantically_correct_detected": "E008",
    "similarity_score": 0.7075,
    "matching_method": "per_run_basename_overlap_best_semantic"
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 97,
    "end_line": 104,
    "error_description": "getByUsername builds a native SQL query via string concatenation of the username, making the endpoint vulnerable to SQL injection (e.g., usernames containing quotes or SQL fragments).",
    "confidence": 0.87,
    "semantically_correct_detected": "E013",
    "similarity_score": 0.6832,
    "matching_method": "per_run_basename_overlap_best_semantic"
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 173,
    "end_line": 187,
    "error_description": "checkLogin calls userRepository.findByUsername(username).get() and immediately dereferences it, so non-existent users cause NoSuchElementException/500 instead of the intended UnauthorizedException, and the dummy hash fallback to mitigate timing attacks is never used.",
    "confidence": 0.86,
    "semantically_correct_detected": "E010",
    "similarity_score": 0.6292,
    "matching_method": "per_run_basename_overlap_best_semantic"
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/AddressServiceImpl.java",
    "start_line": 78,
    "end_line": 89,
    "error_description": "save() maps the request to an Address entity but never persists it via addressRepository.save, so the address is never stored and the response contains a null ID, violating the methodâ€™s purpose.",
    "confidence": 0.88,
    "semantically_correct_detected": "E003",
    "similarity_score": 0.6049,
    "matching_method": "per_run_basename_overlap_best_semantic"
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 161,
    "end_line": 170,
    "error_description": "delete() loads the user but never calls userRepository.delete(...), so the method returns successfully without removing anything from the database.",
    "confidence": 0.79,
    "semantically_correct_detected": "E002",
    "similarity_score": 0.6013,
    "matching_method": "per_run_basename_overlap_best_semantic"
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/controller/AddressController.java",
    "start_line": 44,
    "end_line": 48,
    "error_description": "The create endpoint is restricted to requests with Content-Type text/plain even though it consumes an AddressRequest JSON body, causing legitimate JSON clients to receive 415 Unsupported Media Type responses.",
    "confidence": 0.71,
    "semantically_correct_detected": "E007",
    "similarity_score": 0.5843,
    "matching_method": "per_run_basename_overlap_best_semantic"
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 70,
    "end_line": 81,
    "error_description": "listAll ignores the provided Pageable and loads the entire user table into memory before wrapping it in a PageImpl, so requested page/size parameters and database-level pagination are never honored.",
    "confidence": 0.64,
    "semantically_correct_detected": "E004",
    "similarity_score": 0.5659,
    "matching_method": "per_run_basename_overlap_best_semantic"
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 116,
    "end_line": 118,
    "error_description": "The save method logs the raw username and password on line 117, exposing credentials in application logs and violating security best practices.",
    "confidence": 0.69,
    "semantically_correct_detected": "E014",
    "similarity_score": 0.5099,
    "matching_method": "per_run_basename_overlap_best_semantic"
  }
]