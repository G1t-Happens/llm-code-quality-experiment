[
  {
    "filename": "src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 102,
    "end_line": 103,
    "error_description": "SQL injection vulnerability due to direct string concatenation of unescaped user input 'username' into native SQL query.",
    "confidence": 1.0,
    "semantically_correct_detected": "E013",
    "similarity_score": 0.8811,
    "matching_method": "per_run_basename_overlap_best_semantic"
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/controller/UserController.java",
    "start_line": 59,
    "end_line": 62,
    "error_description": "Missing @PreAuthorize on delete endpoint allows any authenticated user to delete any user account, violating ownership and authorization rules.",
    "confidence": 1.0,
    "semantically_correct_detected": "E015",
    "similarity_score": 0.8333,
    "matching_method": "per_run_basename_overlap_best_semantic"
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/AddressServiceImpl.java",
    "start_line": 67,
    "end_line": 67,
    "error_description": "Inconsistent error handling: addressRepository.findById(addressId).get() throws NoSuchElementException if not found, unlike other methods using orElseThrow for ResourceNotFoundException.",
    "confidence": 0.95,
    "semantically_correct_detected": "E012",
    "similarity_score": 0.7485,
    "matching_method": "per_run_basename_overlap_best_semantic"
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 182,
    "end_line": 184,
    "error_description": "Incorrect handling of non-existent user in login: .get() on Optional throws NoSuchElementException instead of using .orElse(null) for dummy hash comparison, breaking timing attack protection and consistent 401 response.",
    "confidence": 1.0,
    "semantically_correct_detected": "E010",
    "similarity_score": 0.6976,
    "matching_method": "per_run_basename_overlap_best_semantic"
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 75,
    "end_line": 82,
    "error_description": "Pagination ignored: userRepository.findAll() fetches ALL users into memory without applying Pageable, then PageImpl uses full list as page content, causing incorrect results and performance degradation.",
    "confidence": 1.0,
    "semantically_correct_detected": "E004",
    "similarity_score": 0.6299,
    "matching_method": "per_run_basename_overlap_best_semantic"
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 167,
    "end_line": 173,
    "error_description": "Missing userRepository.delete(existingUserEntity); user entity is fetched and logged as deleted but never actually removed from database.",
    "confidence": 1.0,
    "semantically_correct_detected": "E002",
    "similarity_score": 0.6233,
    "matching_method": "per_run_basename_overlap_best_semantic"
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/AddressServiceImpl.java",
    "start_line": 88,
    "end_line": 91,
    "error_description": "Missing addressRepository.save(addressEntity) call; newly created Address entity is not persisted to the database before returning AddressResponse with null ID.",
    "confidence": 1.0,
    "semantically_correct_detected": "E003",
    "similarity_score": 0.4891,
    "matching_method": "per_run_basename_overlap_best_semantic"
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/controller/AddressController.java",
    "start_line": 44,
    "end_line": 46,
    "error_description": "@PostMapping consumes='text/plain' incompatible with @RequestBody AddressRequest (complex object); deserialization will fail as text/plain converter returns String, not object.",
    "confidence": 1.0,
    "semantically_correct_detected": "E007",
    "similarity_score": 0.4743,
    "matching_method": "per_run_basename_overlap_best_semantic"
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/mapper/UserMapper.java",
    "start_line": 55,
    "end_line": 55,
    "error_description": "Double password hashing in update mapping: 'passwordEncoder.encode(passwordEncoder.encode(dto.password()))' prevents updated passwords from matching during login authentication.",
    "confidence": 1.0,
    "semantically_correct_detected": "E001",
    "similarity_score": 0.4462,
    "matching_method": "per_run_basename_overlap_best_semantic"
  }
]