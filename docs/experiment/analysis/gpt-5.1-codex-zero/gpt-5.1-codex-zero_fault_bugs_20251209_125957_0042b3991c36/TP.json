[
  {
    "filename": "src/main/java/com/llmquality/baseline/controller/UserController.java",
    "start_line": 59,
    "end_line": 61,
    "error_description": "The delete user endpoint has no authorization guard (@PreAuthorize), allowing any authenticated user to delete arbitrary users instead of restricting the action to admins/owners.",
    "confidence": 0.78,
    "semantically_correct_detected": "E015",
    "similarity_score": 0.7971,
    "matching_method": "per_run_basename_overlap_best_semantic"
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/AddressServiceImpl.java",
    "start_line": 66,
    "end_line": 73,
    "error_description": "getById calls addressRepository.findById(addressId).get() without checking presence, so a missing address throws NoSuchElementException (500) instead of the intended ResourceNotFoundException (404).",
    "confidence": 0.74,
    "semantically_correct_detected": "E012",
    "similarity_score": 0.7791,
    "matching_method": "per_run_basename_overlap_best_semantic"
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 101,
    "end_line": 104,
    "error_description": "getByUsername builds a native SQL string with direct username concatenation (\"SELECT * FROM users WHERE username = '\" + username + \"'\") allowing SQL injection via the username parameter.",
    "confidence": 0.88,
    "semantically_correct_detected": "E013",
    "similarity_score": 0.7577,
    "matching_method": "per_run_basename_overlap_best_semantic"
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 176,
    "end_line": 189,
    "error_description": "checkLogin calls userRepository.findByUsername(username).get() without handling absent users, leading to NoSuchElementException (500) instead of returning Unauthorized and defeating the constant-time dummy hash logic.",
    "confidence": 0.78,
    "semantically_correct_detected": "E010",
    "similarity_score": 0.6286,
    "matching_method": "per_run_basename_overlap_best_semantic"
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/controller/AddressController.java",
    "start_line": 50,
    "end_line": 53,
    "error_description": "The update endpoint does not annotate the request body with @Validated(Update.class) (or @Valid), so none of the Update-group Bean Validation constraints on AddressRequest ever run and invalid data (e.g., blank street) can be persisted.",
    "confidence": 0.52,
    "semantically_correct_detected": "E009",
    "similarity_score": 0.6164,
    "matching_method": "per_run_basename_overlap_best_semantic"
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/controller/AddressController.java",
    "start_line": 44,
    "end_line": 48,
    "error_description": "The create endpoint is restricted to requests with Content-Type text/plain even though it expects an AddressRequest JSON body, causing normal JSON clients to receive HTTP 415 Unsupported Media Type responses.",
    "confidence": 0.64,
    "semantically_correct_detected": "E007",
    "similarity_score": 0.5988,
    "matching_method": "per_run_basename_overlap_best_semantic"
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 166,
    "end_line": 173,
    "error_description": "delete loads the user but never calls userRepository.delete(...); as a result the user is never removed despite the method reporting success.",
    "confidence": 0.84,
    "semantically_correct_detected": "E002",
    "similarity_score": 0.5929,
    "matching_method": "per_run_basename_overlap_best_semantic"
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/AddressServiceImpl.java",
    "start_line": 77,
    "end_line": 89,
    "error_description": "The save method maps the DTO to an Address but never persists it (no addressRepository.save call) before returning a response, so the address is not stored and its ID remains null.",
    "confidence": 0.86,
    "semantically_correct_detected": "E003",
    "similarity_score": 0.5647,
    "matching_method": "per_run_basename_overlap_best_semantic"
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 120,
    "end_line": 120,
    "error_description": "The save method logs the raw password in plaintext at debug level, leaking sensitive credentials into log files.",
    "confidence": 0.69,
    "semantically_correct_detected": "E014",
    "similarity_score": 0.5647,
    "matching_method": "per_run_basename_overlap_best_semantic"
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/service/UserServiceImpl.java",
    "start_line": 72,
    "end_line": 80,
    "error_description": "listAll ignores the supplied Pageable by loading the entire user table with userRepository.findAll() and wrapping it in a PageImpl, so pagination and limits have no effect and large datasets will be fully loaded into memory.",
    "confidence": 0.57,
    "semantically_correct_detected": "E004",
    "similarity_score": 0.5513,
    "matching_method": "per_run_basename_overlap_best_semantic"
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/controller/UserController.java",
    "start_line": 47,
    "end_line": 51,
    "error_description": "User creation requests are accepted without any Bean Validation because the method lacks @Valid/@Validated(Create.class); NotBlank, Email, and password strength constraints on UserRequest are silently bypassed.",
    "confidence": 0.63,
    "semantically_correct_detected": "E008",
    "similarity_score": 0.5112,
    "matching_method": "per_run_basename_overlap_best_semantic"
  },
  {
    "filename": "src/main/java/com/llmquality/baseline/mapper/UserMapper.java",
    "start_line": 53,
    "end_line": 56,
    "error_description": "updateUserEntityFromUserRequest encodes the password twice (passwordEncoder.encode(passwordEncoder.encode(dto.password()))), producing hashes that will never match login attempts and rendering password updates unusable.",
    "confidence": 0.82,
    "semantically_correct_detected": "E001",
    "similarity_score": 0.3304,
    "matching_method": "per_run_basename_overlap_best_semantic"
  }
]