filename,det_lines,error_description
UserServiceImpl.java,"(181, 189)","Null dereference/NoSuchElementException risk: checkLogin() (lines 176-194) calls userRepository.findByUsername(username).get() without checking if user is present. If username does not exist, this throws NoSuchElementException. This is a nonmalicious development fault (omission, software, internal, development phase). Propagation: erratic failure (500 error). Prevention: check isPresent() before get()."
UserServiceImpl.java,"(118, 132)","Inconsistent password hashing: save() (lines 117-132) uses a new BCryptPasswordEncoder instance instead of the injected passwordEncoder, which may have different configuration (e.g., strength, salt). This is a nonmalicious development fault (design/implementation, software, internal, development phase). Propagation: latent error; may cause login failures or security inconsistencies. Prevention: always use the injected passwordEncoder."
UserServiceImpl.java,"(118, 118)","Sensitive data exposure in logs: save() (line 118) logs plaintext password in debug message. This is a nonmalicious development fault (omission, software, internal, development phase). Propagation: latent error; may lead to credential exposure if logs are accessed. Prevention: never log sensitive data such as passwords."
UserServiceImpl.java,"(55, 55)","Password double-encoding: UserMapper.updateUserEntityFromUserRequest() (see UserMapper.java line 55) encodes password twice (passwordEncoder.encode(passwordEncoder.encode(dto.password()))). This is a nonmalicious development fault (design/implementation, software, internal, development phase). Propagation: latent error; user will not be able to log in after password update. Prevention: encode password only once."
AddressServiceImpl.java,"(65, 74)","NoSuchElementException risk: getById() (lines 65-74) calls addressRepository.findById(addressId).get() without checking if address exists. If addressId does not exist, this throws NoSuchElementException. This is a nonmalicious development fault (omission, software, internal, development phase). Propagation: erratic failure (500 error). Prevention: use orElseThrow() with ResourceNotFoundException as in other methods."
AddressServiceImpl.java,"(87, 89)","Address is not persisted: save() (lines 78-90) creates Address entity and maps to AddressResponse, but does not call addressRepository.save(addressEntity). This is a nonmalicious development fault (omission, software, internal, development phase). Propagation: content failure (address not saved in DB). Prevention: call addressRepository.save(addressEntity) before mapping to response."
