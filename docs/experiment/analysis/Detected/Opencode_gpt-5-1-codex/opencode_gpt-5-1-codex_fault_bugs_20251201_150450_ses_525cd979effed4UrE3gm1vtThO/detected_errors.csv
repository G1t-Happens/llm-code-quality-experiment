filename,start_line,end_line,error_description,semantically_correct_detected
AddressController.java,44,47,"The create endpoint is declared with consumes=""text/plain"" even though it expects a JSON-mapped AddressRequest body, causing standard application/json requests to be rejected with HTTP 415 and preventing address creation.",E007
UserController.java,47,51,"The user creation method accepts UserRequest without @Valid/@Validated(Create.class), so none of the DTO constraints ever execute and invalid usernames/passwords/emails can be persisted unchecked.",E008
UserController.java,59,61,"The DELETE /users/{id} endpoint lacks any @PreAuthorize guard, allowing any caller (even unauthenticated in some setups) to delete arbitrary users, which is a severe authorization vulnerability.",E015
AddressServiceImpl.java,65,74,getById calls addressRepository.findById(...).get() without guarding the Optional; a missing address results in NoSuchElementException and a 500 response instead of the documented ResourceNotFoundException.,E012
AddressServiceImpl.java,78,88,"save() maps the DTO to an Address and immediately maps it back to a response without ever calling addressRepository.save(...), so the address is never persisted and the returned id remains null despite logging that it was saved.",E003
UserMapper.java,55,56,"updateUserEntityFromUserRequest encodes the password twice (passwordEncoder.encode(passwordEncoder.encode(dto.password()))) which produces hashes that will never match the single-encoded login comparisons, breaking password updates.",E001
UserServiceImpl.java,72,81,"listAll ignores the supplied Pageable and loads the entire user table into memory (userRepository.findAll()) before wrapping it in a PageImpl, so page number, size, and sorting parameters have no effect and memory usage grows with the table.",E004
UserServiceImpl.java,98,108,"getByUsername constructs a native SQL string via concatenation (""SELECT * FROM users WHERE username = '"" + username + ""'"") and hands it to the EntityManager, making the endpoint trivially vulnerable to SQL injection and breaking input sanitization.",E013
UserServiceImpl.java,117,119,"The save method logs both the username and the raw password with LOG.debug(""--> save, user with name: {} and password: {}"", ...), leaking sensitive credentials into application logs and violating security best practices.",E014
UserServiceImpl.java,161,173,"delete(Long id) fetches the entity and logs success but never calls userRepository.delete(...), so user records are never actually removed and clients receive a false confirmation.",E002
UserServiceImpl.java,175,189,"checkLogin invokes userRepository.findByUsername(...).get() and only afterwards checks if the user is null, so unknown usernames throw NoSuchElementException and return 500 responses instead of the intended UnauthorizedException with dummy-hash timing protection.",E010