filename,start_line,end_line,error_description,semantically_correct_detected
AddressController.java,55,56,SQL injection vulnerability due to direct string concatenation of username in native query,
UserServiceImpl.java,102,103,"SQL injection vulnerability: native SQL query constructed with direct string concatenation of untrusted user input 'username' from request parameter. This allows attackers to inject arbitrary SQL code via the /users/search?username= endpoint, potentially leading to data exfiltration, modification, or deletion. Problem: bypasses JPA parameterization; use repository findByUsername instead. Impact: high-severity security vulnerability enabling full database compromise.",
UserController.java,59,62,"Missing @PreAuthorize annotation on delete method. Unlike other CRUD methods, no authorization check for admin or ownership, allowing any authenticated user to delete any user account. Problem: relies only on global .authenticated(), no method-level RBAC. Impact: privilege escalation, data loss via unauthorized deletions.",
UserServiceImpl.java,172,172,"Missing userRepository.delete(existingUserEntity) call in delete method. Finds user but logs 'deleted' without persisting deletion. Problem: silent failure, transaction commits without delete. Impact: users cannot be deleted, data retention violation, false success logs.",
AddressServiceImpl.java,86,89,"Missing addressRepository.save(addressEntity) in save method. Creates entity, maps to response (id=null), logs 'saved' with null id, but does not persist. Problem: incomplete CRUD implementation. Impact: addresses not saved to DB, data loss, client receives invalid response with null id.",
AddressServiceImpl.java,67,67,"Unsafe Optional.get() on addressRepository.findById(addressId) without prior existence check. Throws NoSuchElementException if address not found, unhandled by GlobalExceptionHandler. Problem: inconsistent error handling (others use orElseThrow); crashes with 500 instead of 404. Impact: poor UX, potential stack trace leakage.",
UserMapper.java,55,55,"Double password hashing in update mapping expression: passwordEncoder.encode(passwordEncoder.encode(dto.password())). Hashes raw password twice, producing incorrect hash incompatible with single-hash login check. Problem: mapping logic error. Impact: password updates fail authentication, users locked out after update.",
UserServiceImpl.java,181,181,"Unsafe Optional.get() on userRepository.findByUsername(username) in checkLogin. Throws NoSuchElementException if user absent, before dummy hash comparison. Problem: defeats timing attack prevention intent, unhandled exception. Impact: 500 error on invalid login instead of 401, info leak via stack trace.",
UserServiceImpl.java,74,81,"Incorrect pagination in listAll: calls findAll() without Pageable (loads entire table into memory), constructs PageImpl from full list. Ignores client pageable/sort. Problem: in-memory pagination, no DB efficiency. Impact: performance bottleneck, OOM for large datasets, incorrect results.",
AddressController.java,44,44,"@PostMapping(consumes = ""text/plain"") incompatible with @RequestBody AddressRequest (expects JSON). Jackson cannot deserialize JSON body as plain text to record. Problem: HTTP content-type mismatch. Impact: 400 Bad Request on valid JSON POSTs, broken create endpoint.",