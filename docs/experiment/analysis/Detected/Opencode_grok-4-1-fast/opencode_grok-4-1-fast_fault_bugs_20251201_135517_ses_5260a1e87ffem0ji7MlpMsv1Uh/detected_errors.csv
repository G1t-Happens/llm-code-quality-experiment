filename,start_line,end_line,error_description,semantically_correct_detected
AddressServiceImpl.java,67,67,"In getById method, calls Optional.get() on potentially empty Optional from addressRepository.findById(addressId), causing NoSuchElementException runtime error if address does not exist.",E012
AddressServiceImpl.java,86,89,"In save method, maps AddressRequest to Address entity and AddressResponse but omits addressRepository.save(addressEntity), resulting in non-persisted address and response with null ID; misleading log assumes save occurred.",E003
UserServiceImpl.java,182,182,"In checkLogin method, calls Optional.get() on potentially empty Optional from userRepository.findByUsername(username), causing NoSuchElementException if user does not exist.",E010
UserServiceImpl.java,102,104,"In getByUsername method, constructs native SQL query by directly concatenating unescaped user-provided 'username' into the query string ('SELECT * FROM users WHERE username = \'' + username + '\''), exposing SQL injection vulnerability.",E013
UserServiceImpl.java,164,173,"In delete method, retrieves User entity via orElseThrow but omits userRepository.delete(existingUserEntity), leaving user undeleted despite success log message.",E002
UserServiceImpl.java,74,81,"In listAll method, fetches all users with userRepository.findAll() (ignoring Pageable, loading entire table into memory) and constructs PageImpl with full list as content, producing incorrect pagination metadata (always 1 page) and performance bottleneck for large datasets.",E004
UserMapper.java,55,55,"In updateUserEntityFromUserRequest @Mapping for password, double-encodes with passwordEncoder.encode(passwordEncoder.encode(dto.password())), causing login failure after update as stored hash (double) no longer matches single-hashed input.",E001
UserController.java,49,50,"In create method, @RequestBody UserRequest lacks @Validated(UserValidationGroups.Create.class), bypassing required Jakarta Bean Validation constraints (e.g., @NotBlank username/password/email, strong password regex).",E008
AddressController.java,52,53,"In update method (PATCH /{addressId}), @RequestBody AddressRequest lacks @Validated(AddressValidationGroups.Update.class), bypassing validation constraints (e.g., @Pattern for non-empty strings).",E009
AddressController.java,44,47,"@PostMapping specifies consumes=""text/plain"" but accepts JSON DTO (AddressRequest record), causing 415 Unsupported Media Type errors when clients send standard application/json.",E007
UserController.java,59,62,"delete method (@DeleteMapping()) lacks @PreAuthorize (e.g., hasRole('ADMIN')), permitting any authenticated user to delete any user, resulting in unauthorized resource deletion security vulnerability.",E015
UserServiceImpl.java,125,126,"In save method, instantiates new BCryptPasswordEncoder() instead of using injected passwordEncoder bean, risking inconsistent encoding parameters if bean is customized.",E005
UserServiceImpl.java,152,153,"In update method, instantiates new BCryptPasswordEncoder() instead of using injected passwordEncoder bean, risking inconsistent encoding parameters if bean is customized.",E006
