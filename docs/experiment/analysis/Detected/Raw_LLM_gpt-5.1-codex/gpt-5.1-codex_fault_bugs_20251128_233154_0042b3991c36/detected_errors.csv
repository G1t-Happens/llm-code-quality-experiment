filename,start_line,end_line,error_description,semantically_correct_detected
AddressController.java,44,48,"Create endpoint is declared with consumes=""text/plain"" although it expects a JSON AddressRequest. Standard application/json requests are rejected with 415, making the endpoint unusable for normal clients.",E007
AddressController.java,50,53,"The PATCH update endpoint does not annotate the AddressRequest with @Validated(Update.class)/@Valid, so none of the defined bean validation constraints execute on updates and invalid data can be stored.",E009
UserController.java,47,51,"The user creation endpoint lacks @Valid/@Validated(Create.class) on the request body, meaning all bean validation constraints (required username/password/email/admin) are skipped and invalid payloads reach the service layer.",E008
UserController.java,59,61,"DELETE /users/{id} is missing any @PreAuthorize guard, so any authenticated principal can delete arbitrary users regardless of role or ownership, which is a severe authorization flaw.",E015
AddressServiceImpl.java,67,75,"getById calls addressRepository.findById(addressId).get() without checking presence, so a missing address triggers NoSuchElementException and returns 500 instead of the intended 404 ResourceNotFoundException.",E012
AddressServiceImpl.java,80,90,"save() maps the request to an Address entity but never calls addressRepository.save(...). The address is never persisted and the returned response contains a null id, defeating the purpose of the API.",E003
UserServiceImpl.java,73,81,"listAll ignores the supplied Pageable and loads every user with userRepository.findAll(), then returns the full list as one page. Page boundaries, sizes, and sorting are never applied, breaking pagination and hurting performance.",E004
UserServiceImpl.java,99,104,"getByUsername builds a native SQL string via direct concatenation of the username (""SELECT * FROM users WHERE username = '...'""). This is trivially exploitable for SQL injection and should use parameters or repository methods.",E013
UserServiceImpl.java,118,119,"The save method logs both username and the raw password (""user with name: {} and password: {}""). Logging plaintext credentials is a serious security violation and can leak secrets to log files.",E014
UserMapper.java,55,57,updateUserEntityFromUserRequest encodes the password twice (passwordEncoder.encode(passwordEncoder.encode(dto.password()))). Updated passwords become double-hashed and can never match during login.,E001
UserServiceImpl.java,163,172,delete(Long id) retrieves the user but never calls userRepository.delete(...). The API reports success while the user record remains in the database.,E002
UserServiceImpl.java,176,189,"checkLogin invokes userRepository.findByUsername(username).get(); when the username does not exist Optional.get throws NoSuchElementException, resulting in HTTP 500 instead of returning 401 via UnauthorizedException and defeating the constant-time comparison logic.",E010
