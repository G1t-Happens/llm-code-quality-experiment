detected_id,filename,det_lines,error_description
E007,AddressController,"(44, 47)","The address creation endpoint declares `consumes = ""text/plain""` while binding a JSON DTO, causing Spring to return 415/400 for valid JSON requests because no converter can turn plain text into `AddressRequest`."
E009,AddressController,"(50, 53)","The PATCH endpoint accepts `AddressRequest` without `@Validated(Update.class)` (or even `@Valid`), so clients can send invalid data (blank street, malformed postal code, etc.) and it will bypass all Jakarta validation constraints."
E008,UserController,"(47, 51)","User creation lacks any `@Valid/@Validated(Create.class)` on the request body, meaning passwords, emails and usernames are never validated and malformed data is persisted."
E015,UserController,"(59, 61)","`@DeleteMapping` `/users/{id}` has no `@PreAuthorize`, allowing any anonymous caller to delete arbitrary users, which is a critical security vulnerability."
E012,AddressServiceImpl,"(65, 73)",`getById` calls `addressRepository.findById(addressId).get()`; when the ID does not exist it throws `NoSuchElementException` and returns 500 instead of the intended 404 `ResourceNotFoundException`.
E003,AddressServiceImpl,"(78, 89)","`save` maps the DTO to an entity and immediately maps it back to a response without ever calling `addressRepository.save`, so no address is persisted and the returned DTO always has a null id."
E001,UserMapper,"(53, 56)","`updateUserEntityFromUserRequest` encodes the password twice (`passwordEncoder.encode(passwordEncoder.encode(dto.password()))`), producing hashes that will never match during login and locking users out after an update."
E004,UserServiceImpl,"(71, 80)","`listAll` ignores the supplied `Pageable`, loads the entire user table into memory, and wraps it in a `PageImpl`, so pagination and sorting parameters from the API are silently ignored and large datasets will exhaust memory."
E013,UserServiceImpl,"(98, 107)","`getByUsername` builds SQL via string concatenation (`SELECT * FROM users WHERE username = '...')` and feeds it directly to `EntityManager`, allowing SQL injection if a crafted username is supplied."
E014,UserServiceImpl,"(117, 119)","The save method logs both the username and the raw password (`""user with name: {} and password: {}""`), leaking credentials into log files and violating security best practices."
E002,UserServiceImpl,"(161, 172)","`delete` loads the user but never calls `userRepository.delete(...)`, so DELETE requests report success without actually removing anything from the database."
E010,UserServiceImpl,"(175, 188)","`checkLogin` calls `userRepository.findByUsername(username).get()`; missing users cause `NoSuchElementException` (500) before the dummy hash logic can run, defeating the intended timing attack mitigation and skipping the proper 401 response."
