gt_id,filename,gt_lines,det_lines,severity_gt,severity_det,gt_description,det_description
E016,UserServiceImpl.java,"(103, 109)","(103, 104)",critical,critical,"Username parameter is concatenated directly into SQL, allowing an attacker to retrieve data via SQL injections","SQL injection vulnerability: constructs SQL with unescaped user input (username) in getByUsername(). Allows arbitrary SQL execution, violating security (ISO 25010: Security, Integrity, Confidentiality)."
E013,UserServiceImpl.java,"(182, 182)","(182, 183)",critical,critical,Calling .get() on findByUsername() causes a NoSuchElementException (HTTP 500) on every login attempt with a non-existent username instead of returning the intended HTTP 401 Unauthorized,"NullPointerException risk and authentication bypass: userRepository.findByUsername(username).get() is called without checking if user exists. If user is not found, NoSuchElementException is thrown, leaking existence of usernames and breaking login flow. Violates security and reliability."
E017,UserServiceImpl.java,"(119, 119)","(119, 127)",critical,high,"Logs include user passwords in plaintext, potentially exposing them in logs accessible to operators or attackers","Password is hashed using a new BCryptPasswordEncoder instance instead of the injected PasswordEncoder, which may have different configuration (e.g., strength, salt). This can cause authentication failures and inconsistent password hashes, violating maintainability and security."
E006,UserServiceImpl.java,"(153, 153)","(153, 154)",medium,high,PasswordEncoder created per request rather than as a singleton,"Password is re-hashed using a new BCryptPasswordEncoder instance instead of the injected PasswordEncoder, leading to inconsistent password hashes and possible authentication failures. Violates maintainability and security."
E001,UserMapper.java,"(56, 56)","(55, 56)",medium,high,Double encryption of the password using a password encoder,"Password is double-encoded: passwordEncoder.encode(passwordEncoder.encode(dto.password())). This results in an invalid hash, making user authentication impossible. Violates functional correctness and security."
E015,AddressServiceImpl.java,"(67, 67)","(67, 68)",critical,high,Replacing .orElseThrow() with .get() in AddressServiceImpl.getById() causes an unhandled NoSuchElementException and returns HTTP 500 instead of the proper HTTP 404 whenever a client requests a non-existent address ID,"AddressServiceImpl.getById() uses addressRepository.findById(addressId).get() without checking if the address exists, causing NoSuchElementException and leaking information about address existence. Violates reliability and security."
E003,AddressServiceImpl.java,"(78, 90)","(86, 89)",critical,high,Missing save call in the repository/data access layer,"Address entity is created but not persisted: addressRepository.save(addressEntity) is missing in save(). This causes the address not to be saved in the database, resulting in data loss and functional incompleteness."
E002,UserServiceImpl.java,"(164, 174)","(164, 174)",critical,high,Missing delete call in the repository/data access layer,"UserServiceImpl.delete() does not actually delete the user entity from the database. This results in a no-op, violating functional correctness and persistence (ISO 25010: Functional Suitability, Reliability)."
E012,AddressController.java,"(48, 48)","(42, 46)",medium,high,"The update() Endpoint uses PUT, but business logic uses partial field updates. API is hard to use correctly and does not convey the intended behavior clearly to clients","AddressController.create() uses @PostMapping(consumes = ""text/plain"") instead of the standard ""application/json"". This breaks HTTP contract, causing clients to fail when sending JSON, violating interoperability and usability."
E018,UserController.java,"(57, 58)","(58, 60)",critical,high,"Removing @PreAuthorize(admin) from the user deletion endpoint allows any authenticated user to permanently delete any account, including all administrators, leading to immediate and irreversible loss of system ownership","UserController.delete() endpoint is missing @PreAuthorize, allowing any authenticated user to delete any user account. This is a privilege escalation and security breach."
E004,UserServiceImpl.java,"(75, 80)","(75, 80)",high,medium,Loading all users before pagination and transform them to DTOs â€“ wrong order,"UserServiceImpl.listAll() ignores pagination by fetching all users and then paginating in memory. This causes performance and scalability issues for large datasets, violating performance and resource utilization."
