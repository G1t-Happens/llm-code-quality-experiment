gt_id,filename,gt_lines,det_lines,severity_gt,severity_det,gt_description,det_description
E016,UserServiceImpl.java,"(103, 109)","(103, 104)",critical,critical,"Username parameter is concatenated directly into SQL, allowing an attacker to retrieve data via SQL injections","SQL injection vulnerability: constructs SQL with unescaped user input (username) in getByUsername, allowing arbitrary SQL execution. Violates ISO 25010 Security (Integrity, Confidentiality, Authenticity) and Clean Code (Correctness, Safety)."
E013,UserServiceImpl.java,"(182, 182)","(182, 183)",critical,critical,Calling .get() on findByUsername() causes a NoSuchElementException (HTTP 500) on every login attempt with a non-existent username instead of returning the intended HTTP 401 Unauthorized,"Null dereference and authentication bypass: userRepository.findByUsername(username).get() will throw NoSuchElementException if user not found, resulting in 500 error instead of proper 401. Also, password check is performed after this, so DUMMY_HASH is never used, breaking timing attack mitigation. Violates ISO 25010 Reliability, Security, and Clean Code (User error protection, Fault tolerance)."
E017,UserServiceImpl.java,"(119, 119)","(119, 127)",critical,high,"Logs include user passwords in plaintext, potentially exposing them in logs accessible to operators or attackers","Password hashing inconsistency: uses a new BCryptPasswordEncoder instance for hashing in save (and update), instead of the injected passwordEncoder. This can cause different hash parameters (e.g., strength, salt) and breaks dependency injection, violating Maintainability and Security (ISO 25010)."
E006,UserServiceImpl.java,"(153, 153)","(153, 154)",medium,high,PasswordEncoder created per request rather than as a singleton,"Password hashing inconsistency: update uses a new BCryptPasswordEncoder instance instead of the injected passwordEncoder, causing possible hash parameter mismatch and breaking dependency injection. Violates Maintainability and Security."
E002,UserServiceImpl.java,"(164, 174)","(173, 174)",critical,high,Missing delete call in the repository/data access layer,User deletion does not actually remove the user entity from the database; only logs the deletion. This results in data persistence errors and violates functional correctness and reliability (ISO 25010).
E001,UserMapper.java,"(56, 56)","(55, 56)",medium,high,Double encryption of the password using a password encoder,"Double password hashing: updateUserEntityFromUserRequest encodes the password twice (passwordEncoder.encode(passwordEncoder.encode(dto.password()))), resulting in unusable password hashes and breaking authentication. Violates Functional Correctness and Security."
E012,AddressController.java,"(48, 48)","(42, 46)",medium,high,"The update() Endpoint uses PUT, but business logic uses partial field updates. API is hard to use correctly and does not convey the intended behavior clearly to clients","Incorrect content type: @PostMapping(consumes = ""text/plain"") for create address endpoint expects plain text, but AddressRequest is a JSON DTO. This causes 415 errors for standard JSON clients and breaks HTTP contract (ISO 25010 Functional Suitability, Usability)."
E003,AddressServiceImpl.java,"(78, 90)","(86, 89)",critical,high,Missing save call in the repository/data access layer,"Address entity is created and mapped to response without persisting to the database (missing addressRepository.save). Causes data loss and inconsistency between API and persistence layer. Violates Functional Correctness, Reliability, and Data Integrity."
E015,AddressServiceImpl.java,"(67, 67)","(67, 68)",critical,high,Replacing .orElseThrow() with .get() in AddressServiceImpl.getById() causes an unhandled NoSuchElementException and returns HTTP 500 instead of the proper HTTP 404 whenever a client requests a non-existent address ID,"Direct use of Optional.get() without isPresent() or orElseThrow() in getById can cause NoSuchElementException and 500 error if address not found, violating Reliability and User error protection."
E018,UserController.java,"(57, 58)","(58, 60)",critical,high,"Removing @PreAuthorize(admin) from the user deletion endpoint allows any authenticated user to permanently delete any account, including all administrators, leading to immediate and irreversible loss of system ownership","User deletion endpoint lacks @PreAuthorize, allowing any authenticated user to delete any user. This is a privilege escalation and security breach (ISO 25010 Security: Access Control, Integrity)."
E004,UserServiceImpl.java,"(75, 80)","(75, 80)",high,medium,Loading all users before pagination and transform them to DTOs â€“ wrong order,"listAll ignores pagination: fetches all users with findAll(), then pages in memory, causing performance and scalability issues for large datasets. Violates ISO 25010 Performance and Resource Utilization."
