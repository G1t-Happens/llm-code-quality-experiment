gt_id,filename,gt_lines,det_lines,severity_gt,severity_det,gt_description,det_description
E016,UserServiceImpl.java,"(103, 109)","(103, 104)",critical,critical,"Username parameter is concatenated directly into SQL, allowing an attacker to retrieve data via SQL injections","SQL injection vulnerability: constructs SQL with unescaped user input (username) in getByUsername, allowing arbitrary SQL execution. Violates ISO 25010 Security (Integrity, Confidentiality) and Clean Code (never build SQL with user input)."
E013,UserServiceImpl.java,"(182, 182)","(182, 183)",critical,critical,Calling .get() on findByUsername() causes a NoSuchElementException (HTTP 500) on every login attempt with a non-existent username instead of returning the intended HTTP 401 Unauthorized,"NullPointerException risk and authentication bypass: userRepository.findByUsername(username).get() will throw if user not found, but DUMMY_HASH fallback is only used after. This allows crash (availability) and leaks timing info (security). Should use orElse(null) and check for null before password check."
E017,UserServiceImpl.java,"(119, 119)","(119, 119)",critical,high,"Logs include user passwords in plaintext, potentially exposing them in logs accessible to operators or attackers","Logs plaintext password in save() method, violating security (confidentiality) and Clean Code. Logging sensitive data is a major security breach."
E005,UserServiceImpl.java,"(126, 126)","(126, 127)",medium,high,PasswordEncoder created per request rather than as a singleton,"Uses a new BCryptPasswordEncoder instance for hashing in save(), instead of the injected PasswordEncoder. This breaks consistency, may cause login failures, and violates DRY and maintainability."
E006,UserServiceImpl.java,"(153, 153)","(153, 154)",medium,high,PasswordEncoder created per request rather than as a singleton,"Uses a new BCryptPasswordEncoder instance for hashing in update(), instead of the injected PasswordEncoder. This breaks consistency, may cause login failures, and violates DRY and maintainability."
E002,UserServiceImpl.java,"(164, 174)","(173, 174)",critical,high,Missing delete call in the repository/data access layer,User entity is not deleted in delete() method; only logs deletion. This causes data persistence loss and violates functional correctness and reliability.
E015,AddressServiceImpl.java,"(65, 65)","(67, 67)",critical,high,Replacing .orElseThrow() with .get() in AddressServiceImpl.getById() causes an unhandled NoSuchElementException and returns HTTP 500 instead of the proper HTTP 404 whenever a client requests a non-existent address ID,"Directly calls .get() on Optional from addressRepository.findById(addressId) in getById(), causing NoSuchElementException if not found. This results in 500 error instead of 404, violating reliability and HTTP contract."
E003,AddressServiceImpl.java,"(76, 88)","(86, 87)",critical,high,Missing save call in the repository/data access layer,"Saves address entity but never persists it: addressMapper.toAddressEntity is called, but addressRepository.save is never invoked. Data is not persisted, violating functional correctness and reliability."
E009,AddressController.java,"(42, 42)","(42, 42)",high,high,Incorrect MIME type in controller. The API expects JSON but text/plain is declared. Clients sending JSON may fail,"@PostMapping consumes = ""text/plain"" for create() endpoint, but expects JSON AddressRequest. This causes HTTP 415 errors and breaks API contract (functional suitability, usability, interoperability)."
E001,UserMapper.java,"(56, 56)","(56, 56)",medium,high,Double encryption of the password using a password encoder,Double-encoding of password in updateUserEntityFromUserRequest: passwordEncoder.encode(passwordEncoder.encode(dto.password())) will break authentication and cause data corruption. Violates functional correctness and maintainability.
E018,UserController.java,"(57, 58)","(58, 60)",critical,high,"Removing @PreAuthorize(admin) from the user deletion endpoint allows any authenticated user to permanently delete any account, including all administrators, leading to immediate and irreversible loss of system ownership","User delete endpoint lacks @PreAuthorize, allowing any authenticated user to delete any user. This is a privilege escalation and security breach (ISO 25010: Security, Integrity, Authenticity)."
E004,UserServiceImpl.java,"(75, 80)","(80, 80)",high,medium,Loading all users before pagination and transform them to DTOs â€“ wrong order,"Pagination is broken in listAll(): fetches all users, then pages in memory. This causes performance and scalability issues for large datasets (resource utilization, capacity)."
E023,LoggingConfig.java,"(51, 52)","(54, 54)",high,medium,Hardcoded Linux-specific log directory. Running this on Windows or another OS will fail or move to an unpredictable location unless manually changed,"Default log file name contains a colon (application:errors.log), which is invalid on Windows and some filesystems. This breaks cross-platform compatibility (ISO 25010: Portability, Installability)."
