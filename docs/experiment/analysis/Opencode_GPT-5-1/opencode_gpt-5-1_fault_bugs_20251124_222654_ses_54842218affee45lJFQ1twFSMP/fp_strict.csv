filename,det_lines,error_description
GlobalExceptionHandler.java,"(47, 51)","Nonmalicious design fault: handleMalformedJson(HttpMessageNotReadableException) echoes ex.getMostSpecificCause().getMessage() directly to clients, potentially leaking low-level parser/internal details that aid attackers in crafting malformed inputs."
SecurityConfig.java,"(95, 110)","Nonmalicious configuration design fault: jwtEncoder/jwtDecoder createSecretKey(String base64Secret) unconditionally Base64-decodes jwt.secret, but application.properties and .env documentation do not require JWT_SECRET to be Base64; a non-Base64 secret will cause startup-time decoding failures and service outage."
UserServiceImpl.java,"(98, 103)","Nonmalicious development fault: getByUsername(String username) builds a native SQL string with direct username concatenation (""SELECT * FROM users WHERE username = '"" + username + ""'"") and executes it via EntityManager, introducing a SQL injection vector instead of using bind parameters."
UserServiceImpl.java,"(175, 189)","Nonmalicious development fault: checkLogin(LoginRequest) calls userRepository.findByUsername(username).get() without presence check, causing NoSuchElementException and HTTP 500 for unknown users; this also prevents use of the DUMMY_HASH constant and equal-time comparison, reintroducing username-enumeration and inconsistent 401 handling."
User.java,"(68, 77)","Nonmalicious design fault: User.equals/hashCode rely solely on id, so two transient User instances with null ids compare equal and share the same hash, which can corrupt Sets/Maps and cause subtle persistence bugs when handling unsaved entities."
Address.java,"(104, 113)","Nonmalicious design fault: Address.equals/hashCode also rely only on id, making multiple transient Address instances with null ids equal and hash-colliding, which can break collection semantics and lead to lost or overwritten addresses before persistence."
AddressServiceImpl.java,"(65, 73)","Nonmalicious development fault: getById(Long userId, Long addressId) uses addressRepository.findById(addressId).get() without Optional presence handling, yielding NoSuchElementException and HTTP 500 instead of a controlled 404/ownership-checked response when the address is missing."
AddressServiceImpl.java,"(80, 83)","Nonmalicious development fault: in save(Long userId, AddressRequest), the error log message on missing user is copy-pasted as ""<-- getById, User with userId {} not found"", which mislabels the failing operation and complicates operational debugging."
application.properties,"(21, 24)","Nonmalicious configuration/design fault: spring.jpa.hibernate.ddl-auto=update is enabled alongside explicit Flyway migrations (V1__create_tables.sql, V2__insert_data.sql), allowing Hibernate to mutate the schema at runtime and drift from the migration baseline, jeopardizing reproducibility and long-term schema integrity."
